!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@ag-grid-community/all-modules"),require("@angular/material/button"),require("@angular/material/icon"),require("@angular/material/checkbox"),require("@angular/forms"),require("@ngx-translate/core"),require("@angular/material/dialog"),require("@angular/common"),require("@angular/material/menu"),require("@ag-grid-community/angular"),require("@angular/common/http"),require("@angular/platform-browser/animations"),require("@angular/router"),require("@sitmun/frontend-core"),require("@angular/common/locales/ca"),require("@angular/common/locales/es"),require("@angular/cdk/a11y"),require("@angular/cdk/drag-drop"),require("@angular/cdk/portal"),require("@angular/cdk/scrolling"),require("@angular/cdk/stepper"),require("@angular/cdk/table"),require("@angular/cdk/tree"),require("@angular/material/autocomplete"),require("@angular/material/badge"),require("@angular/material/bottom-sheet"),require("@angular/material/button-toggle"),require("@angular/material/card"),require("@angular/material/chips"),require("@angular/material/stepper"),require("@angular/material/datepicker"),require("@angular/material/divider"),require("@angular/material/expansion"),require("@angular/material/grid-list"),require("@angular/material/input"),require("@angular/material/list"),require("@angular/material/core"),require("@angular/material/paginator"),require("@angular/material/progress-bar"),require("@angular/material/progress-spinner"),require("@angular/material/radio"),require("@angular/material/select"),require("@angular/material/sidenav"),require("@angular/material/slider"),require("@angular/material/slide-toggle"),require("@angular/material/snack-bar"),require("@angular/material/sort"),require("@angular/material/table"),require("@angular/material/tabs"),require("@angular/material/toolbar"),require("@angular/material/tooltip"),require("@angular/material/tree"),require("@angular/material/form-field"),require("@ngx-translate/http-loader"),require("rxjs"),require("@angular/cdk/collections")):"function"==typeof define&&define.amd?define("@sitmun/frontend-gui",["exports","@angular/core","@ag-grid-community/all-modules","@angular/material/button","@angular/material/icon","@angular/material/checkbox","@angular/forms","@ngx-translate/core","@angular/material/dialog","@angular/common","@angular/material/menu","@ag-grid-community/angular","@angular/common/http","@angular/platform-browser/animations","@angular/router","@sitmun/frontend-core","@angular/common/locales/ca","@angular/common/locales/es","@angular/cdk/a11y","@angular/cdk/drag-drop","@angular/cdk/portal","@angular/cdk/scrolling","@angular/cdk/stepper","@angular/cdk/table","@angular/cdk/tree","@angular/material/autocomplete","@angular/material/badge","@angular/material/bottom-sheet","@angular/material/button-toggle","@angular/material/card","@angular/material/chips","@angular/material/stepper","@angular/material/datepicker","@angular/material/divider","@angular/material/expansion","@angular/material/grid-list","@angular/material/input","@angular/material/list","@angular/material/core","@angular/material/paginator","@angular/material/progress-bar","@angular/material/progress-spinner","@angular/material/radio","@angular/material/select","@angular/material/sidenav","@angular/material/slider","@angular/material/slide-toggle","@angular/material/snack-bar","@angular/material/sort","@angular/material/table","@angular/material/tabs","@angular/material/toolbar","@angular/material/tooltip","@angular/material/tree","@angular/material/form-field","@ngx-translate/http-loader","rxjs","@angular/cdk/collections"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).sitmun=e.sitmun||{},e.sitmun["frontend-gui"]={}),e.ng.core,e.allModules,e.ng.material.button,e.ng.material.icon,e.ng.material.checkbox,e.ng.forms,e.i2$1,e.ng.material.dialog,e.ng.common,e.ng.material.menu,e.i5,e.ng.common.http,e.ng.platformBrowser.animations,e.ng.router,e.frontendCore,e.ng.common.locales.ca,e.ng.common.locales.es,e.ng.cdk.a11y,e.ng.cdk.dragDrop,e.ng.cdk.portal,e.ng.cdk.scrolling,e.ng.cdk.stepper,e.ng.cdk.table,e.ng.cdk.tree,e.ng.material.autocomplete,e.ng.material.badge,e.ng.material.bottomSheet,e.ng.material.buttonToggle,e.ng.material.card,e.ng.material.chips,e.ng.material.stepper,e.ng.material.datepicker,e.ng.material.divider,e.ng.material.expansion,e.ng.material.gridList,e.ng.material.input,e.ng.material.list,e.ng.material.core,e.ng.material.paginator,e.ng.material.progressBar,e.ng.material.progressSpinner,e.ng.material.radio,e.ng.material.select,e.ng.material.sidenav,e.ng.material.slider,e.ng.material.slideToggle,e.ng.material.snackBar,e.ng.material.sort,e.ng.material.table,e.ng.material.tabs,e.ng.material.toolbar,e.ng.material.tooltip,e.ng.material.tree,e.ng.material.formField,e.httpLoader,e.rxjs,e.ng.cdk.collections)}(this,(function(e,t,n,i,a,o,r,l,d,s,u,c,p,g,m,f,h,v,C,b,M,x,y,S,w,k,D,E,A,B,R,I,N,T,F,O,P,_,V,q,G,j,H,L,J,$,z,U,W,K,Q,X,Y,Z,ee,te,ne,ie){"use strict";function ae(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var oe=ae(h),re=ae(v);Object.create;function le(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function de(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,a,o=n.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)r.push(i.value)}catch(e){a={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return r}Object.create;var se=function(){function e(){}return e.prototype.agInit=function(e){this.params=e},e.prototype.refresh=function(e){return!0},e.prototype.btnClickedHandler=function(e){this.params.clicked(this.params.value)},e.prototype.getParams=function(){return this.params},e.prototype.ngOnDestroy=function(){},e}();se.ɵfac=function(e){return new(e||se)},se.ɵcmp=t.ɵɵdefineComponent({type:se,selectors:[["app-btn-edit-rendered"]],decls:3,vars:0,consts:[["mat-mini-fab","","type","button",1,"buttonEdit",3,"click"],["fontSet","material-icons-round",1,"iconEdit"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"button",0),t.ɵɵlistener("click",(function(e){return n.btnClickedHandler(e)})),t.ɵɵelementStart(1,"mat-icon",1),t.ɵɵtext(2," edit "),t.ɵɵelementEnd(),t.ɵɵelementEnd())},directives:[i.MatButton,a.MatIcon],styles:[".buttonEdit[_ngcontent-%COMP%]{background-color:#ddd;box-shadow:none;color:#000;height:20px;margin-top:3px;width:20px}.iconEdit[_ngcontent-%COMP%]{font-size:13px;margin-left:-2px;margin-top:-10px}"]});var ue=function(){function e(){}return e.prototype.agInit=function(e){this.params=e},e.prototype.refresh=function(e){return this.params=e,!0},e.prototype.invokeParentMethod=function(){this.params.context.componentParent.methodFromParent("Row: "+this.params.node.rowIndex+", Col: "+this.params.colDef.headerName)},e.prototype.btnCheckedHandler=function(e){var t=!e.target.firstElementChild.checked,n=this.params.column.colId;this.params.value=t,this.params.api.undoRedoService.isFilling=!0,this.params.node.setDataValue(n,t)},e.prototype.getParams=function(){return this.params},e.prototype.ngOnDestroy=function(){},e}();ue.ɵfac=function(e){return new(e||ue)},ue.ɵcmp=t.ɵɵdefineComponent({type:ue,selectors:[["app-btn-checkbox-rendered"]],decls:1,vars:2,consts:[[3,"value","checked","click"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"mat-checkbox",0),t.ɵɵlistener("click",(function(e){return n.btnCheckedHandler(e)})),t.ɵɵelementEnd()),2&e&&t.ɵɵproperty("value",n.params.value)("checked",n.params.value)},directives:[o.MatCheckbox],styles:[""]});var ce=["input"],pe=function(){function e(){this.text=""}return e.prototype.agInit=function(e){this.params=e,this.valueGetter=e.filterParams.valueGetter,this.params.suppressFilterButton=!0},e.prototype.isFilterActive=function(){return null!=this.text&&""!==this.text},e.prototype.doesFilterPass=function(e){var t=this;return this.text.toLowerCase().split(" ").every((function(n){return t.valueGetter(e.node).toString().toLowerCase().indexOf(n)>=0}))},e.prototype.getModel=function(){return{value:this.text}},e.prototype.setModel=function(e){this.text=e?e.value:""},e.prototype.onChange=function(e){this.params.parentFilterInstance((function(t){t.onFloatingFilterChanged("contains",e)}))},e.prototype.onParentModelChanged=function(e){this.currentValue=e?e.filter:0},e}();pe.ɵfac=function(e){return new(e||pe)},pe.ɵcmp=t.ɵɵdefineComponent({type:pe,selectors:[["app-btn-checkbox-filter"]],viewQuery:function(e,n){var i;(1&e&&t.ɵɵviewQuery(ce,!0,t.ViewContainerRef),2&e)&&(t.ɵɵqueryRefresh(i=t.ɵɵloadQuery())&&(n.input=i.first))},hostAttrs:[1,"hostClass"],decls:11,vars:9,consts:[[3,"change"],["filterSelect",""],["value",""],["value","true"],["value","false"]],template:function(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"select",0,1),t.ɵɵlistener("change",(function(){t.ɵɵrestoreView(i);var e=t.ɵɵreference(1);return n.onChange(e.value)})),t.ɵɵelementStart(2,"option",2),t.ɵɵtext(3),t.ɵɵpipe(4,"translate"),t.ɵɵelementEnd(),t.ɵɵelementStart(5,"option",3),t.ɵɵtext(6),t.ɵɵpipe(7,"translate"),t.ɵɵelementEnd(),t.ɵɵelementStart(8,"option",4),t.ɵɵtext(9),t.ɵɵpipe(10,"translate"),t.ɵɵelementEnd(),t.ɵɵelementEnd()}2&e&&(t.ɵɵadvance(3),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(4,3,"selectAll")),t.ɵɵadvance(3),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(7,5,"enabled")),t.ɵɵadvance(3),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(10,7,"disabled")))},directives:[r.NgSelectOption,r.ɵangular_packages_forms_forms_x],pipes:[l.TranslatePipe],styles:[".hostClass[_ngcontent-%COMP%]{width:100%}"]});var ge=function(){function e(e){this.dialogRef=e}return e.prototype.ngOnInit=function(){},e.prototype.doAccept=function(){this.dialogRef.close({event:"Accept"})},e.prototype.closeDialog=function(){this.dialogRef.close({event:"Cancel"})},e}();function me(e,n){if(1&e&&t.ɵɵelement(0,"span",17),2&e){var i=t.ɵɵnextContext();t.ɵɵproperty("translate",i.title)}}function fe(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",18),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().deleteChanges()})),t.ɵɵpipe(1,"translate"),t.ɵɵelementStart(2,"mat-icon",19),t.ɵɵtext(3," close "),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var a=t.ɵɵnextContext();t.ɵɵpropertyInterpolate("title",t.ɵɵpipeBind1(1,2,"cancel")),t.ɵɵproperty("disabled",a.changeCounter<=0)}}function he(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",20),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().undo()})),t.ɵɵpipe(1,"translate"),t.ɵɵelementStart(2,"mat-icon",19),t.ɵɵtext(3," undo "),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var a=t.ɵɵnextContext();t.ɵɵpropertyInterpolate("title",t.ɵɵpipeBind1(1,2,"undo")),t.ɵɵproperty("disabled",a.changeCounter<=0)}}function ve(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",21),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().redo()})),t.ɵɵpipe(1,"translate"),t.ɵɵelementStart(2,"mat-icon",19),t.ɵɵtext(3," redo "),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var a=t.ɵɵnextContext();t.ɵɵpropertyInterpolate("title",t.ɵɵpipeBind1(1,2,"redo")),t.ɵɵproperty("disabled",a.redoCounter<=0)}}function Ce(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",22),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().applyChanges()})),t.ɵɵpipe(1,"translate"),t.ɵɵelementStart(2,"mat-icon",19),t.ɵɵtext(3," check "),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var a=t.ɵɵnextContext();t.ɵɵpropertyInterpolate("title",t.ɵɵpipeBind1(1,2,"accept")),t.ɵɵproperty("disabled",a.changeCounter<=0)}}function be(e,n){1&e&&t.ɵɵelement(0,"label",17),2&e&&t.ɵɵproperty("translate","search")}function Me(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"input",23),t.ɵɵlistener("keyup",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().quickSearch()}))("ngModelChange",(function(e){return t.ɵɵrestoreView(i),t.ɵɵnextContext().searchValue=e})),t.ɵɵelementEnd()}if(2&e){var a=t.ɵɵnextContext();t.ɵɵproperty("ngModel",a.searchValue)}}function xe(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",24),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().removeData()})),t.ɵɵelementStart(1,"mat-icon",19),t.ɵɵtext(2," delete "),t.ɵɵelementEnd(),t.ɵɵelement(3,"span",17),t.ɵɵelementEnd()}2&e&&(t.ɵɵadvance(3),t.ɵɵproperty("translate","remove"))}function ye(e,n){if(1&e&&(t.ɵɵelementStart(0,"button",25),t.ɵɵelement(1,"span",17),t.ɵɵelementStart(2,"mat-icon",19),t.ɵɵtext(3," keyboard_arrow_down "),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e){t.ɵɵnextContext();var i=t.ɵɵreference(12);t.ɵɵproperty("matMenuTriggerFor",i),t.ɵɵadvance(1),t.ɵɵproperty("translate","actions")}}function Se(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",26),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().exportData()})),t.ɵɵtext(1),t.ɵɵpipe(2,"translate"),t.ɵɵelementEnd()}2&e&&(t.ɵɵadvance(1),t.ɵɵtextInterpolate1(" ",t.ɵɵpipeBind1(2,1,"export")," "))}function we(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",26),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().onDuplicateButtonClicked()})),t.ɵɵtext(1),t.ɵɵpipe(2,"translate"),t.ɵɵelementEnd()}2&e&&(t.ɵɵadvance(1),t.ɵɵtextInterpolate1(" ",t.ɵɵpipeBind1(2,1,"duplicate"),""))}function ke(e,n){1&e&&(t.ɵɵelementStart(0,"button",27),t.ɵɵtext(1),t.ɵɵpipe(2,"translate"),t.ɵɵelementEnd()),2&e&&(t.ɵɵadvance(1),t.ɵɵtextInterpolate1(" ",t.ɵɵpipeBind1(2,1,"search/replace"),""))}function De(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",28),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().newData()})),t.ɵɵelementStart(1,"mat-icon",19),t.ɵɵtext(2," add_circle_outline "),t.ɵɵelementEnd(),t.ɵɵelement(3,"span",17),t.ɵɵelementEnd()}2&e&&(t.ɵɵadvance(3),t.ɵɵproperty("translate","new"))}function Ee(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",28),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().onAddButtonClicked()})),t.ɵɵelementStart(1,"mat-icon",19),t.ɵɵtext(2," add_circle_outline "),t.ɵɵelementEnd(),t.ɵɵelement(3,"span",17),t.ɵɵelementEnd()}2&e&&(t.ɵɵadvance(3),t.ɵɵproperty("translate","add"))}ge.ɵfac=function(e){return new(e||ge)(t.ɵɵdirectiveInject(d.MatDialogRef))},ge.ɵcmp=t.ɵɵdefineComponent({type:ge,selectors:[["app-dialog-message"]],decls:12,vars:8,consts:[["mat-dialog-title",""],[1,"mat-typography"],["align","end"],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"h2",0),t.ɵɵtext(1),t.ɵɵelementEnd(),t.ɵɵelementStart(2,"mat-dialog-content",1),t.ɵɵelementStart(3,"p"),t.ɵɵtext(4),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(5,"mat-dialog-actions",2),t.ɵɵelementStart(6,"button",3),t.ɵɵlistener("click",(function(){return n.closeDialog()})),t.ɵɵtext(7),t.ɵɵpipe(8,"translate"),t.ɵɵelementEnd(),t.ɵɵelementStart(9,"button",4),t.ɵɵlistener("click",(function(){return n.doAccept()})),t.ɵɵtext(10),t.ɵɵpipe(11,"translate"),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e&&(t.ɵɵadvance(1),t.ɵɵtextInterpolate(n.title),t.ɵɵadvance(3),t.ɵɵtextInterpolate1(" ",n.message," "),t.ɵɵadvance(3),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(8,4,"cancel")),t.ɵɵadvance(3),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(11,6,"accept")))},directives:[d.MatDialogTitle,d.MatDialogContent,d.MatDialogActions,i.MatButton],pipes:[l.TranslatePipe],styles:[""]});var Ae=function(){function e(e,i){var a=this;this.dialog=e,this.translate=i,this.modules=n.AllCommunityModules,this.statusColumn=!1,this.changesMap=new Map,this.modificationChange=!1,this.undoNoChanges=!1,this.translate=i,this.frameworkComponents={btnEditRendererComponent:se,btnCheckboxRendererComponent:ue,btnCheckboxFilterComponent:pe},this.remove=new t.EventEmitter,this.new=new t.EventEmitter,this.add=new t.EventEmitter,this.sendChanges=new t.EventEmitter,this.getSelectedRows=new t.EventEmitter,this.duplicate=new t.EventEmitter,this.getAllRows=new t.EventEmitter,this.changeCounter=0,this.previousChangeCounter=0,this.redoCounter=0,this.gridOptions={defaultColDef:{sortable:!0,flex:1,filter:!0,editable:!this.nonEditable,cellStyle:{backgroundColor:"#FFFFFF"},suppressMenu:!0,resizable:!0},columnTypes:{dateColumn:{filter:"agDateColumnFilter",filterParams:{comparator:function(e,t){var n=new Date(t),i=new Date(e);return n.getTime()<i.getTime()?-1:n.getTime()>i.getTime()?1:0}},suppressMenu:!0}},rowSelection:"multiple",singleClickEdit:!0,localeTextFunc:function(e,t){var n=a.translate.instant(e);return n===e?t:n}}}return e.prototype.ngOnInit=function(){var e=this;this.eventRefreshSubscription&&(this._eventRefreshSubscription=this.eventRefreshSubscription.subscribe((function(){e.getElements()}))),this.eventGetSelectedRowsSubscription&&(this._eventGetSelectedRowsSubscription=this.eventGetSelectedRowsSubscription.subscribe((function(){e.emitSelectedRows()}))),this.eventGetAllRowsSubscription&&(this._eventGetAllRowsSubscription=this.eventGetAllRowsSubscription.subscribe((function(){e.emitAllRows()}))),this.eventAddItemsSubscription&&this.eventAddItemsSubscription.subscribe((function(t){e.addItems(t)}))},e.prototype.onGridReady=function(e){var t,n;this.singleSelection&&(this.gridOptions.rowSelection="single"),this.params=e,this.gridApi=e.api,this.gridColumnApi=e.columnApi,this.getElements(),this.gridApi.sizeColumnsToFit(),console.log(this.columnDefs);try{for(var i=le(this.columnDefs),a=i.next();!a.done;a=i.next()){"status"===a.value.field&&(console.log("status column true"),this.statusColumn=!0)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.emitSelectedRows=function(){var e=this.gridApi.getSelectedNodes().map((function(e){return e.data}));this.getSelectedRows.emit(e)},e.prototype.emitAllRows=function(){var e=[];this.gridApi.forEachNode((function(t){return e.push(t.data)})),this.getAllRows.emit(e)},e.prototype.getColumnKeysAndHeaders=function(e){var t=[];return 0==this.columnDefs.length?"":(this.gridOptions.columnApi.getAllDisplayedColumns().forEach((function(n){""!==n.userProvidedColDef.headerName&&(e.push(n.userProvidedColDef.field),t.push(n.userProvidedColDef.headerName))})),t.join(","))},e.prototype.exportData=function(){var e=[],t={onlySelected:!0,columnKeys:e,customHeader:this.getColumnKeysAndHeaders(e),skipHeader:!0};this.gridApi.exportDataAsCsv(t)},e.prototype.quickSearch=function(){this.gridApi.setQuickFilter(this.searchValue)},e.prototype.getElements=function(){var e=this;this.getAll().subscribe((function(t){e.rowData=t,setTimeout((function(){e.gridApi.sizeColumnsToFit()}),30),e.gridApi.setRowData(e.rowData),console.log(e.rowData)}))},e.prototype.addItems=function(e){var t=this;console.log(e);var n=[];e.forEach((function(e){null==e.id||null==t.rowData.find((function(t){return t.id===e.id}))?(t.statusColumn&&(e.status="Pending creation"),n.push(e),t.rowData.push(e)):console.log("Item with the ID "+e.id+" already exists")})),this.gridApi.updateRowData({add:n}),console.log(this.columnDefs)},e.prototype.removeData=function(){var e,t;this.gridApi.stopEditing(!1);var n=this.gridApi.getSelectedNodes(),i=n.map((function(e){return e.data}));if(this.remove.emit(i),this.statusColumn){var a=n.map((function(e){return e.rowIndex}));try{for(var o=le(a),r=o.next();!r.done;r=o.next()){var l=r.value;this.gridApi.getRowNode(l).data.status="Deleted"}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}this.gridOptions.api.refreshCells()}this.gridOptions.api.deselectAll()},e.prototype.newData=function(){this.gridApi.stopEditing(!1),this.new.emit(-1)},e.prototype.onAddButtonClicked=function(){this.gridApi.stopEditing(!1),this.add.emit(-1)},e.prototype.onDuplicateButtonClicked=function(){var e=this;if(this.gridApi.stopEditing(!1),console.log(this.changeCounter),this.changeCounter>0){var t=this.dialog.open(ge);t.componentInstance.title="Caution",t.componentInstance.message="If you duplicate rows without apply changes, your modifications will be overwritted, do you want to continue?",t.afterClosed().subscribe((function(t){if(t&&"Accept"===t.event){var n=e.gridApi.getSelectedNodes().map((function(e){return e.data}));e.duplicate.emit(n)}}))}else{var n=this.gridApi.getSelectedNodes().map((function(e){return e.data}));this.duplicate.emit(n)}},e.prototype.applyChanges=function(){var e,t,n=[];this.gridApi.stopEditing(!1);try{for(var i=le(this.changesMap.keys()),a=i.next();!a.done;a=i.next()){var o=a.value;n.push(this.gridApi.getRowNode(o).data)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this.sendChanges.emit(n),this.changesMap.clear(),this.changeCounter=0,this.previousChangeCounter=0,this.redoCounter=0,this.params.colDef.cellStyle={backgroundColor:"#FFFFFF"},this.gridApi.redrawRows()},e.prototype.deleteChanges=function(){for(this.gridApi.stopEditing(!1);this.changeCounter>0;)this.undo();this.changesMap.clear(),this.redoCounter=0},e.prototype.onFilterModified=function(){this.deleteChanges()},e.prototype.undo=function(){this.gridApi.stopEditing(!1),this.gridApi.undoCellEditing(),this.changeCounter-=1,this.redoCounter+=1},e.prototype.redo=function(){this.gridApi.stopEditing(!1),this.gridApi.redoCellEditing(),this.changeCounter+=1,this.redoCounter-=1},e.prototype.onCellEditingStopped=function(e){this.modificationChange&&(this.changeCounter++,this.redoCounter=0,this.onCellValueChanged(e),this.modificationChange=!1)},e.prototype.onCellValueChanged=function(e){if(console.log("value Change"),this.params=e,this.changeCounter>this.previousChangeCounter){if(e.oldValue!==e.value&&(null!=e.oldValue||""!==e.value)){if(this.changesMap.has(e.node.id))if(this.changesMap.get(e.node.id).has(e.colDef.field)){var t=this.changesMap.get(e.node.id).get(e.colDef.field);this.changesMap.get(e.node.id).set(e.colDef.field,t+1)}else this.changesMap.get(e.node.id).set(e.colDef.field,1);else{var n=new Map;n.set(e.colDef.field,1),this.changesMap.set(e.node.id,n),this.statusColumn&&(this.gridApi.getRowNode(e.node.id).data.status="Modified")}this.paintCells(e,this.changesMap),this.previousChangeCounter++}}else if(this.changeCounter<this.previousChangeCounter){t=-1;if(this.changesMap.has(e.node.id)&&(t=this.changesMap.get(e.node.id).get(e.colDef.field)),1===t)if(this.changesMap.get(e.node.id).delete(e.colDef.field),0===this.changesMap.get(e.node.id).size){this.changesMap.delete(e.node.id);var i=this.gridApi.getDisplayedRowAtIndex(e.rowIndex);this.statusColumn&&(this.gridApi.getRowNode(e.node.id).data.status=""),this.gridApi.redrawRows({rowNodes:[i]})}else this.paintCells(e,this.changesMap);else t>1&&(this.changesMap.get(e.node.id).set(e.colDef.field,t-1),this.paintCells(e,this.changesMap));this.previousChangeCounter--}else if(null!=e.oldValue||""!==e.value){var a=void 0;if(a=null==e.value?"":e.value.toString(),null!=e.oldValue&&null!=e.oldValue&&e.oldValue.toString()!==a.toString()||(null==e.oldValue||null==e.oldValue)&&null!=a){if(this.modificationChange=!0,"btnCheckboxRendererComponent"==e.colDef.cellRenderer){var o={cellValueChanges:this.gridApi.undoRedoService.cellValueChanges};this.gridApi.undoRedoService.pushActionsToUndoStack(o),this.gridApi.undoRedoService.isFilling=!1,this.onCellEditingStopped(e)}}else this.modificationWithoutChanges(e)}else this.modificationWithoutChanges(e)},e.prototype.modificationWithoutChanges=function(e){this.changesMap.has(e.node.id)?this.undoNoChanges?this.undoNoChanges=!1:(this.gridApi.undoCellEditing(),this.undoNoChanges=!0,this.paintCells(e,this.changesMap)):this.undoNoChanges?this.undoNoChanges=!1:(this.gridApi.undoCellEditing(),this.undoNoChanges=!0)},e.prototype.getColumnIndexByColId=function(e,t){return e.getAllColumns().findIndex((function(e){return e.getColId()===t}))},e.prototype.paintCells=function(e,t){var n=this.gridApi.getDisplayedRowAtIndex(e.rowIndex);this.changeCellStyleColumns(e,t,"#E8F1DE"),this.gridApi.redrawRows({rowNodes:[n]}),this.changeCellStyleColumns(e,t,"#FFFFFF")},e.prototype.changeCellStyleColumns=function(e,t,n){var i,a;try{for(var o=le(t.get(e.node.id).keys()),r=o.next();!r.done;r=o.next()){var l=r.value,d=this.getColumnIndexByColId(this.gridColumnApi,l);this.gridColumnApi.columnController.gridColumns[d].colDef.cellStyle={backgroundColor:n}}}catch(e){i={error:e}}finally{try{r&&!r.done&&(a=o.return)&&a.call(o)}finally{if(i)throw i.error}}},e}();Ae.ɵfac=function(e){return new(e||Ae)(t.ɵɵdirectiveInject(d.MatDialog),t.ɵɵdirectiveInject(l.TranslateService))},Ae.ɵcmp=t.ɵɵdefineComponent({type:Ae,selectors:[["app-data-grid"]],inputs:{eventRefreshSubscription:"eventRefreshSubscription",eventGetSelectedRowsSubscription:"eventGetSelectedRowsSubscription",eventGetAllRowsSubscription:"eventGetAllRowsSubscription",eventAddItemsSubscription:"eventAddItemsSubscription",frameworkComponents:"frameworkComponents",columnDefs:"columnDefs",getAll:"getAll",discardChangesButton:"discardChangesButton",undoButton:"undoButton",redoButton:"redoButton",applyChangesButton:"applyChangesButton",deleteButton:"deleteButton",newButton:"newButton",actionButton:"actionButton",addButton:"addButton",globalSearch:"globalSearch",themeGrid:"themeGrid",singleSelection:"singleSelection",nonEditable:"nonEditable",title:"title",hideExportButton:"hideExportButton",hideDuplicateButton:"hideDuplicateButton",hideSearchReplaceButton:"hideSearchReplaceButton"},outputs:{remove:"remove",new:"new",add:"add",sendChanges:"sendChanges",duplicate:"duplicate",getSelectedRows:"getSelectedRows",getAllRows:"getAllRows"},decls:21,vars:27,consts:[["id","grup1",1,"editDivBtns"],[3,"translate",4,"ngIf"],["mat-mini-fab","","class","editBtn","id","deleteChangesButton","type","button",3,"title","disabled","click",4,"ngIf"],["mat-mini-fab","","class","editBtn","id","undo",3,"title","disabled","click",4,"ngIf"],["mat-mini-fab","","class","editBtn","id","redo",3,"title","disabled","click",4,"ngIf"],["mat-mini-fab","","class","editBtn","id","applyChangesButton",3,"title","disabled","click",4,"ngIf"],["id","grup2",1,"actionsDivBtns"],["type","text","class","searchGenericInput","placeholder","","ml-2","",3,"ngModel","keyup","ngModelChange",4,"ngIf"],["mat-stroked-button","","id","deleteButton",3,"click",4,"ngIf"],["mat-stroked-button","","id","actionButton",3,"matMenuTriggerFor",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",4,"ngIf"],["mat-stroked-button","","id","newButton",3,"click",4,"ngIf"],[1,"row",2,"height","100%"],["id","myGrid",2,"width","100%","height","100%"],["rowSelection","multiple","multiSortKey","key",2,"width","100%","height","100%",3,"floatingFilter","rowData","columnDefs","gridOptions","animateRows","pagination","modules","undoRedoCellEditing","undoRedoCellEditingLimit","suppressRowClickSelection","frameworkComponents","filterModified","cellEditingStopped","cellValueChanged","gridReady"],[3,"translate"],["mat-mini-fab","","id","deleteChangesButton","type","button",1,"editBtn",3,"title","disabled","click"],["fontSet","material-icons-round"],["mat-mini-fab","","id","undo",1,"editBtn",3,"title","disabled","click"],["mat-mini-fab","","id","redo",1,"editBtn",3,"title","disabled","click"],["mat-mini-fab","","id","applyChangesButton",1,"editBtn",3,"title","disabled","click"],["type","text","placeholder","","ml-2","",1,"searchGenericInput",3,"ngModel","keyup","ngModelChange"],["mat-stroked-button","","id","deleteButton",3,"click"],["mat-stroked-button","","id","actionButton",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item",""],["mat-stroked-button","","id","newButton",3,"click"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"div",0),t.ɵɵtemplate(1,me,1,1,"span",1),t.ɵɵtemplate(2,fe,4,4,"button",2),t.ɵɵtemplate(3,he,4,4,"button",3),t.ɵɵtemplate(4,ve,4,4,"button",4),t.ɵɵtemplate(5,Ce,4,4,"button",5),t.ɵɵelementEnd(),t.ɵɵelementStart(6,"div",6),t.ɵɵtemplate(7,be,1,1,"label",1),t.ɵɵtemplate(8,Me,1,1,"input",7),t.ɵɵtemplate(9,xe,4,1,"button",8),t.ɵɵtemplate(10,ye,4,2,"button",9),t.ɵɵelementStart(11,"mat-menu",null,10),t.ɵɵtemplate(13,Se,3,3,"button",11),t.ɵɵtemplate(14,we,3,3,"button",11),t.ɵɵtemplate(15,ke,3,3,"button",12),t.ɵɵelementEnd(),t.ɵɵtemplate(16,De,4,1,"button",13),t.ɵɵtemplate(17,Ee,4,1,"button",13),t.ɵɵelementEnd(),t.ɵɵelementStart(18,"div",14),t.ɵɵelementStart(19,"div",15),t.ɵɵelementStart(20,"ag-grid-angular",16),t.ɵɵlistener("filterModified",(function(){return n.onFilterModified()}))("cellEditingStopped",(function(e){return n.onCellEditingStopped(e)}))("cellValueChanged",(function(e){return n.onCellValueChanged(e)}))("gridReady",(function(e){return n.onGridReady(e)})),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e&&(t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.title),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.discardChangesButton),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.undoButton),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.redoButton),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.applyChangesButton),t.ɵɵadvance(2),t.ɵɵproperty("ngIf",n.globalSearch),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.globalSearch),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.deleteButton),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.actionButton),t.ɵɵadvance(3),t.ɵɵproperty("ngIf",!n.hideExportButton),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",!n.hideDuplicateButton),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",!n.hideSearchReplaceButton),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.newButton),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.addButton),t.ɵɵadvance(3),t.ɵɵclassMap(n.themeGrid),t.ɵɵproperty("floatingFilter",!0)("rowData",n.rowData)("columnDefs",n.columnDefs)("gridOptions",n.gridOptions)("animateRows",!0)("pagination",!1)("modules",n.modules)("undoRedoCellEditing",!0)("undoRedoCellEditingLimit",200)("suppressRowClickSelection",!0)("frameworkComponents",n.frameworkComponents))},directives:[s.NgIf,u._MatMenu,c.AgGridAngular,l.TranslateDirective,i.MatButton,a.MatIcon,r.DefaultValueAccessor,r.NgControlStatus,r.NgModel,u.MatMenuTrigger,u.MatMenuItem],pipes:[l.TranslatePipe],styles:["input[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{display:inline-block;margin:5px 5px 5px 10px}#newButton[_ngcontent-%COMP%]{background:#68a225 0 0 no-repeat padding-box;color:#fff;margin-left:3px}#actionButton[_ngcontent-%COMP%], #deleteButton[_ngcontent-%COMP%]{background:#fff 0 0 no-repeat padding-box;margin-left:3px}#actionButton[_ngcontent-%COMP%]{text-align:center!important}#applyChangesButton[_ngcontent-%COMP%]{background:#68a225 0 0 no-repeat padding-box;color:#fff!important;margin-left:3px}#applyChangesButton[disabled][_ngcontent-%COMP%]{background:#83976c 0 0 no-repeat padding-box}#redo[_ngcontent-%COMP%]{background:#ff9300;color:#fff!important;margin-left:3px}#redo[disabled][_ngcontent-%COMP%]{background:#ffc97f;margin-left:3px}#undo[_ngcontent-%COMP%]{background:#ff9300;color:#fff!important;margin-left:3px}#undo[disabled][_ngcontent-%COMP%]{background:#ffc97f;margin-left:3px}#deleteChangesButton[_ngcontent-%COMP%]{background:#df3133;color:#fff!important}#deleteChangesButton[disabled][_ngcontent-%COMP%]{background:#da8c8e;color:#fff!important}.editDivBtns[_ngcontent-%COMP%]{height:30px!important;line-height:30px!important;margin-left:10px;text-align:start;width:130px}.actionsDivBtns[_ngcontent-%COMP%]{height:60px;text-align:end;width:calc(100% - 140px)}.actionsDivBtns[_ngcontent-%COMP%], .editDivBtns[_ngcontent-%COMP%]{display:inline-block!important}.actionsDivBtns[_ngcontent-%COMP%]   .mat-stroked-button[_ngcontent-%COMP%]{padding:5px 20px!important}.editDivBtns[_ngcontent-%COMP%]   .mat-mini-fab[_ngcontent-%COMP%]   .mat-button-wrapper[_ngcontent-%COMP%]{display:inherit!important;padding:inherit!important}.editDivBtns[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{bottom:5px;height:30px!important;position:relative}.editDivBtns[_ngcontent-%COMP%]   .mat-mini-fab[_ngcontent-%COMP%]{height:30px;width:30px}.actionsDivBtns[_ngcontent-%COMP%]   .searchGenericInput[_ngcontent-%COMP%]{height:45px!important;width:45%!important}.ag-body-viewport.ag-layout-normal[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#eee}​[_ngcontent-%COMP%]   .ag-body-viewport.ag-layout-normal[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar{height:2em;width:2em}.ag-body-viewport.ag-layout-normal[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-button{background:#ccc}.ag-body-viewport.ag-layout-normal[_ngcontent-%COMP%]::-webkit-scrollbar-track-piece{background:#888}"]});var Be=function(){};Be.ɵmod=t.ɵɵdefineNgModule({type:Be}),Be.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||Be)},imports:[C.A11yModule,y.CdkStepperModule,S.CdkTableModule,w.CdkTreeModule,b.DragDropModule,k.MatAutocompleteModule,D.MatBadgeModule,E.MatBottomSheetModule,i.MatButtonModule,A.MatButtonToggleModule,B.MatCardModule,o.MatCheckboxModule,R.MatChipsModule,I.MatStepperModule,N.MatDatepickerModule,d.MatDialogModule,T.MatDividerModule,F.MatExpansionModule,O.MatGridListModule,a.MatIconModule,P.MatInputModule,_.MatListModule,u.MatMenuModule,V.MatNativeDateModule,q.MatPaginatorModule,G.MatProgressBarModule,j.MatProgressSpinnerModule,H.MatRadioModule,V.MatRippleModule,L.MatSelectModule,J.MatSidenavModule,$.MatSliderModule,z.MatSlideToggleModule,U.MatSnackBarModule,W.MatSortModule,K.MatTableModule,Q.MatTabsModule,X.MatToolbarModule,Y.MatTooltipModule,Z.MatTreeModule,M.PortalModule,x.ScrollingModule,ee.MatFormFieldModule]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(Be,{exports:[C.A11yModule,y.CdkStepperModule,S.CdkTableModule,w.CdkTreeModule,b.DragDropModule,k.MatAutocompleteModule,D.MatBadgeModule,E.MatBottomSheetModule,i.MatButtonModule,A.MatButtonToggleModule,B.MatCardModule,o.MatCheckboxModule,R.MatChipsModule,I.MatStepperModule,N.MatDatepickerModule,d.MatDialogModule,T.MatDividerModule,F.MatExpansionModule,O.MatGridListModule,a.MatIconModule,P.MatInputModule,_.MatListModule,u.MatMenuModule,V.MatNativeDateModule,q.MatPaginatorModule,G.MatProgressBarModule,j.MatProgressSpinnerModule,H.MatRadioModule,V.MatRippleModule,L.MatSelectModule,J.MatSidenavModule,$.MatSliderModule,z.MatSlideToggleModule,U.MatSnackBarModule,W.MatSortModule,K.MatTableModule,Q.MatTabsModule,X.MatToolbarModule,Y.MatTooltipModule,Z.MatTreeModule,M.PortalModule,x.ScrollingModule,ee.MatFormFieldModule]});var Re=function(e){return{"margin-top":e}};function Ie(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"div",6),t.ɵɵelementStart(1,"app-data-grid",7),t.ɵɵlistener("getSelectedRows",(function(e){return t.ɵɵrestoreView(i),t.ɵɵnextContext().joinRowsReceived(e)})),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var a=n.$implicit,o=n.index,r=t.ɵɵnextContext();t.ɵɵproperty("ngStyle",t.ɵɵpureFunction1(9,Re,o>0?"100px":"0px")),t.ɵɵadvance(1),t.ɵɵproperty("columnDefs",r.columnDefsTable[o])("themeGrid",r.themeGrid)("getAll",a)("globalSearch",!0)("singleSelection",r.singleSelectionTable[o])("title",r.titlesTable[o])("nonEditable",r.nonEditable)("eventGetSelectedRowsSubscription",r.getAllRows.asObservable())}}var Ne=function(){function e(e){this.dialogRef=e,this.getAllRows=new ne.Subject,this.allRowsReceived=[],this.joinTables=new t.EventEmitter,this.tablesReceivedCounter=0}return e.prototype.ngOnInit=function(){var e=this;this.addButtonClickedSubscription&&(this._addButtonClickedSubscription=this.addButtonClickedSubscription.subscribe((function(){e.getAllSelectedRows()})))},e.prototype.getAllSelectedRows=function(){this.getAllRows.next(!0)},e.prototype.joinRowsReceived=function(e){this.allRowsReceived.push(e),this.tablesReceivedCounter++,this.tablesReceivedCounter===this.getAllsTable.length&&(this.doAdd(this.allRowsReceived),console.log(this.allRowsReceived))},e.prototype.doAdd=function(e){this.dialogRef.close({event:"Add",data:e})},e.prototype.closeDialog=function(){this.dialogRef.close({event:"Cancel"})},e}();function Te(e,n){1&e&&t.ɵɵelementContainer(0)}Ne.ɵfac=function(e){return new(e||Ne)(t.ɵɵdirectiveInject(d.MatDialogRef))},Ne.ɵcmp=t.ɵɵdefineComponent({type:Ne,selectors:[["app-dialog-grid"]],outputs:{joinTables:"joinTables"},decls:11,vars:8,consts:[["mat-dialog-title",""],[1,"dialogConent"],["class","appDialogDataGridDiv",3,"ngStyle",4,"ngFor","ngForOf"],["mat-dialog-actions","","align","end"],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"],[1,"appDialogDataGridDiv",3,"ngStyle"],[3,"columnDefs","themeGrid","getAll","globalSearch","singleSelection","title","nonEditable","eventGetSelectedRowsSubscription","getSelectedRows"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"h4",0),t.ɵɵtext(1),t.ɵɵelementEnd(),t.ɵɵelementStart(2,"mat-dialog-content",1),t.ɵɵtemplate(3,Ie,2,11,"div",2),t.ɵɵelementEnd(),t.ɵɵelementStart(4,"div",3),t.ɵɵelementStart(5,"button",4),t.ɵɵlistener("click",(function(){return n.closeDialog()})),t.ɵɵtext(6),t.ɵɵpipe(7,"translate"),t.ɵɵelementEnd(),t.ɵɵelementStart(8,"button",5),t.ɵɵlistener("click",(function(){return n.getAllSelectedRows()})),t.ɵɵtext(9),t.ɵɵpipe(10,"translate"),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e&&(t.ɵɵadvance(1),t.ɵɵtextInterpolate(n.title),t.ɵɵadvance(2),t.ɵɵproperty("ngForOf",n.getAllsTable),t.ɵɵadvance(3),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(7,4,"cancel")),t.ɵɵadvance(3),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(10,6,"add")))},directives:[d.MatDialogTitle,d.MatDialogContent,s.NgForOf,d.MatDialogActions,i.MatButton,s.NgStyle,Ae],pipes:[l.TranslatePipe],styles:[".dialogConent[_ngcontent-%COMP%]{height:100%;margin:inherit!important;max-height:60vh!important;overflow:auto;padding:inherit!important;width:100%}"]});var Fe=function(){function e(e){this.dialogRef=e}return e.prototype.ngOnInit=function(){},e.prototype.doAdd=function(){this.dialogRef.close({event:"Add"})},e.prototype.closeDialog=function(){this.dialogRef.close({event:"Cancel"})},e}();function Oe(e,n){if(1&e&&(t.ɵɵelementStart(0,"mat-icon",8),t.ɵɵtext(1," folder "),t.ɵɵelementEnd()),2&e){var i=t.ɵɵnextContext().$implicit;t.ɵɵattribute("aria-label",i.type+"icon")}}function Pe(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",7),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=t.ɵɵnextContext().$implicit;return t.ɵɵnextContext().onButtonClicked(e.id,"newFolder")})),t.ɵɵelementStart(1,"mat-icon"),t.ɵɵtext(2,"create_new_folder"),t.ɵɵelementEnd(),t.ɵɵelementEnd()}}function _e(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",7),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=t.ɵɵnextContext().$implicit;return t.ɵɵnextContext().onButtonClicked(e.id,"newNode")})),t.ɵɵelementStart(1,"mat-icon"),t.ɵɵtext(2,"playlist_add"),t.ɵɵelementEnd(),t.ɵɵelementEnd()}}function Ve(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"mat-tree-node",3),t.ɵɵlistener("mouseenter",(function(){t.ɵɵrestoreView(i);var e=n.$implicit;return t.ɵɵnextContext().dragHover(e)}))("mouseleave",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().dragHoverEnd()}))("cdkDragStarted",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().dragStart()}))("cdkDragReleased",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().dragEnd()})),t.ɵɵelement(1,"button",4),t.ɵɵtemplate(2,Oe,2,1,"mat-icon",5),t.ɵɵtext(3),t.ɵɵtemplate(4,Pe,3,0,"button",6),t.ɵɵtemplate(5,_e,3,0,"button",6),t.ɵɵelementStart(6,"button",7),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=n.$implicit;return t.ɵɵnextContext().onButtonClicked(e.id,"edit")})),t.ɵɵelementStart(7,"mat-icon"),t.ɵɵtext(8,"edit"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var a=n.$implicit;t.ɵɵproperty("cdkDragData",a),t.ɵɵadvance(2),t.ɵɵproperty("ngIf","folder"===a.type),t.ɵɵadvance(1),t.ɵɵtextInterpolate1(" ",a.name," "),t.ɵɵadvance(1),t.ɵɵproperty("ngIf","folder"===a.type),t.ɵɵadvance(1),t.ɵɵproperty("ngIf","folder"===a.type)}}function qe(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",7),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=t.ɵɵnextContext().$implicit;return t.ɵɵnextContext().onButtonClicked(e.id,"newFolder")})),t.ɵɵelementStart(1,"mat-icon"),t.ɵɵtext(2,"create_new_folder"),t.ɵɵelementEnd(),t.ɵɵelementEnd()}}function Ge(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",7),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=t.ɵɵnextContext().$implicit;return t.ɵɵnextContext().onButtonClicked(e.id,"newNode")})),t.ɵɵelementStart(1,"mat-icon"),t.ɵɵtext(2,"playlist_add"),t.ɵɵelementEnd(),t.ɵɵelementEnd()}}function je(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"mat-tree-node",9),t.ɵɵlistener("mouseenter",(function(){t.ɵɵrestoreView(i);var e=n.$implicit;return t.ɵɵnextContext().dragHover(e)}))("mouseleave",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().dragHoverEnd()}))("cdkDragStarted",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().dragStart()}))("cdkDragReleased",(function(){return t.ɵɵrestoreView(i),t.ɵɵnextContext().dragEnd()})),t.ɵɵelementStart(1,"button",10),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=n.$implicit;return t.ɵɵnextContext().expansionModel.toggle(e.id)})),t.ɵɵelementStart(2,"mat-icon",11),t.ɵɵtext(3),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(4,"mat-icon",8),t.ɵɵtext(5," folder "),t.ɵɵelementEnd(),t.ɵɵtext(6),t.ɵɵtemplate(7,qe,3,0,"button",6),t.ɵɵtemplate(8,Ge,3,0,"button",6),t.ɵɵelementStart(9,"button",7),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=n.$implicit;return t.ɵɵnextContext().onButtonClicked(e.id,"edit")})),t.ɵɵelementStart(10,"mat-icon"),t.ɵɵtext(11,"edit"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var a=n.$implicit,o=t.ɵɵnextContext();t.ɵɵproperty("cdkDragData",a),t.ɵɵadvance(1),t.ɵɵattribute("aria-label","toggle "+a.name),t.ɵɵadvance(2),t.ɵɵtextInterpolate1(" ",o.treeControl.isExpanded(a)?"expand_more":"chevron_right"," "),t.ɵɵadvance(1),t.ɵɵattribute("aria-label",a.type+"icon"),t.ɵɵadvance(2),t.ɵɵtextInterpolate1(" ",a.name," "),t.ɵɵadvance(1),t.ɵɵproperty("ngIf","folder"===a.type),t.ɵɵadvance(1),t.ɵɵproperty("ngIf","folder"===a.type)}}Fe.ɵfac=function(e){return new(e||Fe)(t.ɵɵdirectiveInject(d.MatDialogRef))},Fe.ɵcmp=t.ɵɵdefineComponent({type:Fe,selectors:[["app-dialog-form"]],decls:11,vars:8,consts:[["mat-dialog-title",""],[1,"mat-typography"],[4,"ngTemplateOutlet"],["align","end"],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"h2",0),t.ɵɵtext(1),t.ɵɵelementEnd(),t.ɵɵelementStart(2,"mat-dialog-content",1),t.ɵɵtemplate(3,Te,1,0,"ng-container",2),t.ɵɵelementEnd(),t.ɵɵelementStart(4,"mat-dialog-actions",3),t.ɵɵelementStart(5,"button",4),t.ɵɵlistener("click",(function(){return n.closeDialog()})),t.ɵɵtext(6),t.ɵɵpipe(7,"translate"),t.ɵɵelementEnd(),t.ɵɵelementStart(8,"button",5),t.ɵɵlistener("click",(function(){return n.doAdd()})),t.ɵɵtext(9),t.ɵɵpipe(10,"translate"),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e&&(t.ɵɵadvance(1),t.ɵɵtextInterpolate(n.title),t.ɵɵadvance(2),t.ɵɵproperty("ngTemplateOutlet",n.HTMLReceived),t.ɵɵadvance(3),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(7,4,"Cancel")),t.ɵɵadvance(3),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(10,6,"Accept")))},directives:[d.MatDialogTitle,d.MatDialogContent,s.NgTemplateOutlet,d.MatDialogActions,i.MatButton],pipes:[l.TranslatePipe],styles:[""]});var He=function(){},Le=function(e,t,n,i,a){this.expandable=e,this.name=t,this.level=n,this.type=i,this.id=a},Je=function(){function e(){this.dataChange=new ne.BehaviorSubject([])}return Object.defineProperty(e.prototype,"data",{get:function(){return this.dataChange.value},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e){var t=this.buildFileTree(e,0);this.dataChange.next(t)},e.prototype.buildFileTree=function(e,t,n){void 0===n&&(n="0");var i={};return e.forEach((function(e){var t=e;if(t.children=[],t.type=e.isFolder?"folder":"node",i[t.id]){var n=i[t.id].children;i[t.id]=t,i[t.id].children=n}else i[t.id]=t;var a=t.parent||"root";i[a]||(i[a]={children:[]}),i[a].children.push(t)})),i.root.type="folder",i.root.name="Root",i.root.isFolder=!0,i.root},e}();Je.ɵfac=function(e){return new(e||Je)},Je.ɵprov=t.ɵɵdefineInjectable({token:Je,factory:Je.ɵfac});var $e=function(){function e(e){this.database=e,this.expansionModel=new ie.SelectionModel(!0),this.dragging=!1,this.expandDelay=1e3,this.validateDrop=!1,this.transformer=function(e,t){return 0!=e.children.length?new Le(!!e.children,e.name,t,e.type,e.id):new Le(!1,e.name,t,e.type,e.id)},this._getLevel=function(e){return e.level},this._isExpandable=function(e){return e.expandable},this._getChildren=function(e){return ne.of(e.children)},this.hasChild=function(e,t){return t.expandable},this.emitNode=new t.EventEmitter,this.createNode=new t.EventEmitter,this.createFolder=new t.EventEmitter,this.emitAllNodes=new t.EventEmitter,this.treeFlattener=new Z.MatTreeFlattener(this.transformer,this._getLevel,this._isExpandable,this._getChildren),this.treeControl=new w.FlatTreeControl(this._getLevel,this._isExpandable),this.dataSource=new Z.MatTreeFlatDataSource(this.treeControl,this.treeFlattener)}return e.prototype.ngOnInit=function(){var e=this;this.eventNodeUpdatedSubscription&&this.eventNodeUpdatedSubscription.subscribe((function(t){e.updateNode(t)})),this.eventCreateNodeSubscription&&this.eventCreateNodeSubscription.subscribe((function(t){t.isFolder?e.createNewFolder(t):e.createNewNode(t)})),this.eventGetAllRowsSubscription&&(this._eventGetAllRowsSubscription=this.eventGetAllRowsSubscription.subscribe((function(){e.emitAllRows()}))),this.getAll().subscribe((function(t){e.treeData=t,e.database.initialize(e.treeData),e.database.dataChange.subscribe((function(t){return e.rebuildTreeForData([t])}))}))},e.prototype.visibleNodes=function(){var e=this,t=[];return this.dataSource.data.forEach((function(n){!function e(n,i){t.push(n),-1!=i.indexOf(n.id)&&n.children.map((function(t){return e(t,i)}))}(n,e.expansionModel.selected)})),t},e.prototype.findNodeSiblings=function(e,t){var n,i,a=this;return e.forEach((function(o,r){o.id===t?n=e:o.children&&(i=a.findNodeSiblings(o.children,t))&&(n=i)})),n},e.prototype.drop=function(e){if(e.isPointerOverContainer){var t=this.visibleNodes(),n=JSON.parse(JSON.stringify(this.dataSource.data)),i=t[e.currentIndex],a=this.findNodeSiblings(n,i.id);if(a){var o=a.findIndex((function(e){return e.id===i.id})),r=e.item.data,l=this.findNodeSiblings(n,r.id),d=l.findIndex((function(e){return e.id===r.id})),s=l.splice(d,1)[0];if(i.id!==s.id){var u=this.treeControl.dataNodes.find((function(e){return i.id===e.id}));this.validateDrop&&u.level!==r.level?alert("Items can only be moved within the same level."):(a.splice(o,0,s),this.rebuildTreeForData(n))}}}},e.prototype.dragStart=function(){this.dragging=!0},e.prototype.dragEnd=function(){this.dragging=!1},e.prototype.dragHover=function(e){var t=this;this.dragging&&(clearTimeout(this.expandTimeout),this.expandTimeout=setTimeout((function(){t.treeControl.expand(e)}),this.expandDelay))},e.prototype.dragHoverEnd=function(){this.dragging&&clearTimeout(this.expandTimeout)},e.prototype.rebuildTreeForData=function(e){var t=this;this.dataSource.data=e,this.expansionModel.selected.forEach((function(e){var n=t.treeControl.dataNodes.find((function(t){return t.id===e}));t.treeControl.expand(n)}))},e.prototype.expandNodesById=function(e,t){var n=this;if(e&&0!==e.length){var i=new Set(t);return e.forEach((function(e){if(i.has(e.id)){n.treeControl.expand(e);for(var t=n.getParentNode(e);t;)n.treeControl.expand(t),t=n.getParentNode(t)}}))}},e.prototype.getParentNode=function(e){var t=e.level;if(t<1)return null;for(var n=this.treeControl.dataNodes.indexOf(e)-1;n>=0;n--){var i=this.treeControl.dataNodes[n];if(i.level<t)return i}return null},e.prototype.updateNode=function(e){var t=JSON.parse(JSON.stringify(this.dataSource.data)),n=this.findNodeSiblings(t,e.id),i=n.findIndex((function(t){return t.id===e.id}));n[i]=e,this.rebuildTreeForData(t)},e.prototype.createNewFolder=function(e){e.type="folder";var t=JSON.parse(JSON.stringify(this.dataSource.data));if(null===e.parent)t.push(e);else{var n=this.findNodeSiblings(t,e.parent),i=n.findIndex((function(t){return t.id===e.parent}));n[i].children.push(e)}this.rebuildTreeForData(t)},e.prototype.createNewNode=function(e){e.type="node";var t=JSON.parse(JSON.stringify(this.dataSource.data)),n=this.findNodeSiblings(t,e.parent),i=n.findIndex((function(t){return t.id===e.parent}));n[i].children.push(e),this.rebuildTreeForData(t)},e.prototype.onButtonClicked=function(e,t){var n=JSON.parse(JSON.stringify(this.dataSource.data)),i=this.findNodeSiblings(n,e);"edit"===t?this.emitNode.emit(i.find((function(t){return t.id===e}))):"newFolder"===t?this.createFolder.emit(i.find((function(t){return t.id===e}))):"newNode"===t&&this.createNode.emit(i.find((function(t){return t.id===e})))},e.prototype.emitAllRows=function(){var e=JSON.parse(JSON.stringify(this.dataSource.data)),t=this.getChildren(e);this.emitAllNodes.emit(t)},e.prototype.getChildren=function(e){var t,n=this,i=[];return e.forEach((function(e,a){e.children.length>0&&(t=n.getChildren(e.children))&&i.push.apply(i,function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(de(arguments[t]));return e}(t)),i.push(e)})),i},e}();function ze(e){return new te.TranslateHttpLoader(e,"../assets/i18n/",".json")}$e.ɵfac=function(e){return new(e||$e)(t.ɵɵdirectiveInject(Je))},$e.ɵcmp=t.ɵɵdefineComponent({type:$e,selectors:[["app-data-tree"]],inputs:{eventNodeUpdatedSubscription:"eventNodeUpdatedSubscription",eventCreateNodeSubscription:"eventCreateNodeSubscription",eventGetAllRowsSubscription:"eventGetAllRowsSubscription",getAll:"getAll"},outputs:{createNode:"createNode",createFolder:"createFolder",emitNode:"emitNode",emitAllNodes:"emitAllNodes"},features:[t.ɵɵProvidersFeature([Je])],decls:3,vars:3,consts:[["cdkDropList","",3,"dataSource","treeControl","cdkDropListDropped"],["matTreeNodeToggle","","matTreeNodePadding","","cdkDrag","",3,"cdkDragData","mouseenter","mouseleave","cdkDragStarted","cdkDragReleased",4,"matTreeNodeDef"],["matTreeNodePadding","","cdkDrag","",3,"cdkDragData","mouseenter","mouseleave","cdkDragStarted","cdkDragReleased",4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodeToggle","","matTreeNodePadding","","cdkDrag","",3,"cdkDragData","mouseenter","mouseleave","cdkDragStarted","cdkDragReleased"],["mat-icon-button","","disabled",""],["class","type-icon",4,"ngIf"],["mat-icon-button","",3,"click",4,"ngIf"],["mat-icon-button","",3,"click"],[1,"type-icon"],["matTreeNodePadding","","cdkDrag","",3,"cdkDragData","mouseenter","mouseleave","cdkDragStarted","cdkDragReleased"],["mat-icon-button","","matTreeNodeToggle","",3,"click"],[1,"mat-icon-rtl-mirror"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"mat-tree",0),t.ɵɵlistener("cdkDropListDropped",(function(e){return n.drop(e)})),t.ɵɵtemplate(1,Ve,9,5,"mat-tree-node",1),t.ɵɵtemplate(2,je,12,7,"mat-tree-node",2),t.ɵɵelementEnd()),2&e&&(t.ɵɵproperty("dataSource",n.dataSource)("treeControl",n.treeControl),t.ɵɵadvance(2),t.ɵɵproperty("matTreeNodeDefWhen",n.hasChild))},directives:[Z.MatTree,b.CdkDropList,Z.MatTreeNodeDef,Z.MatTreeNode,Z.MatTreeNodeToggle,Z.MatTreeNodePadding,b.CdkDrag,i.MatButton,s.NgIf,a.MatIcon],styles:[".mat-tree-node[_ngcontent-%COMP%]{-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;cursor:move;user-select:none}.mat-tree-node.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 12px 17px 2px rgba(0,0,0,.14),0 5px 22px 4px rgba(0,0,0,.12)}.mat-tree-node.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .mat-tree-node[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .2s cubic-bezier(0,0,.2,1)}"]}),s.registerLocaleData(oe.default,"ca"),s.registerLocaleData(re.default,"es");var Ue=function(){};Ue.ɵmod=t.ɵɵdefineNgModule({type:Ue}),Ue.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||Ue)},providers:[],imports:[[m.RouterModule,p.HttpClientModule,s.CommonModule,r.FormsModule,g.NoopAnimationsModule,f.AngularHalModule,r.ReactiveFormsModule,g.BrowserAnimationsModule,c.AgGridModule.withComponents([]),f.SitmunFrontendCoreModule,Be,l.TranslateModule.forRoot({loader:{provide:l.TranslateLoader,useFactory:ze,deps:[p.HttpClient]}})],p.HttpClientModule,s.CommonModule,r.FormsModule,g.NoopAnimationsModule,f.AngularHalModule,l.TranslateModule,r.ReactiveFormsModule,f.SitmunFrontendCoreModule]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(Ue,{declarations:[Ae,$e,se,ue,pe,Ne,Fe,ge],imports:[m.RouterModule,p.HttpClientModule,s.CommonModule,r.FormsModule,g.NoopAnimationsModule,f.AngularHalModule,r.ReactiveFormsModule,g.BrowserAnimationsModule,c.AgGridModule,f.SitmunFrontendCoreModule,Be,l.TranslateModule],exports:[p.HttpClientModule,s.CommonModule,r.FormsModule,g.NoopAnimationsModule,f.AngularHalModule,l.TranslateModule,r.ReactiveFormsModule,Ae,$e,Ne,Fe,ge,f.SitmunFrontendCoreModule]}),e.BtnCheckboxFilterComponent=pe,e.BtnCheckboxRenderedComponent=ue,e.BtnEditRenderedComponent=se,e.DataGridComponent=Ae,e.DataTreeComponent=$e,e.DialogFormComponent=Fe,e.DialogGridComponent=Ne,e.DialogMessageComponent=ge,e.FileDatabase=Je,e.FileFlatNode=Le,e.FileNode=He,e.SitmunFrontendGuiModule=Ue,e.createTranslateLoader=ze,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=sitmun-frontend-gui.umd.min.js.map