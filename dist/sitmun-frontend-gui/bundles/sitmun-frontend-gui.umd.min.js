!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@ag-grid-community/all-modules"),require("@ngx-translate/core"),require("@angular/material/dialog"),require("@angular/forms"),require("@angular/common"),require("@angular/common/http"),require("@angular/platform-browser/animations"),require("@angular/router"),require("@sitmun/frontend-core"),require("@angular/common/locales/ca"),require("@angular/common/locales/es"),require("@ag-grid-community/angular"),require("@angular/cdk/a11y"),require("@angular/cdk/drag-drop"),require("@angular/cdk/portal"),require("@angular/cdk/scrolling"),require("@angular/cdk/stepper"),require("@angular/cdk/table"),require("@angular/cdk/tree"),require("@angular/material/autocomplete"),require("@angular/material/badge"),require("@angular/material/bottom-sheet"),require("@angular/material/button"),require("@angular/material/button-toggle"),require("@angular/material/card"),require("@angular/material/checkbox"),require("@angular/material/chips"),require("@angular/material/stepper"),require("@angular/material/datepicker"),require("@angular/material/divider"),require("@angular/material/expansion"),require("@angular/material/grid-list"),require("@angular/material/icon"),require("@angular/material/input"),require("@angular/material/list"),require("@angular/material/menu"),require("@angular/material/core"),require("@angular/material/paginator"),require("@angular/material/progress-bar"),require("@angular/material/progress-spinner"),require("@angular/material/radio"),require("@angular/material/select"),require("@angular/material/sidenav"),require("@angular/material/slider"),require("@angular/material/slide-toggle"),require("@angular/material/snack-bar"),require("@angular/material/sort"),require("@angular/material/table"),require("@angular/material/tabs"),require("@angular/material/toolbar"),require("@angular/material/tooltip"),require("@angular/material/tree"),require("@angular/material/form-field"),require("@ngx-translate/http-loader"),require("rxjs"),require("@angular/cdk/collections"),require("@angular/platform-browser"),require("d3")):"function"==typeof define&&define.amd?define("@sitmun/frontend-gui",["exports","@angular/core","@ag-grid-community/all-modules","@ngx-translate/core","@angular/material/dialog","@angular/forms","@angular/common","@angular/common/http","@angular/platform-browser/animations","@angular/router","@sitmun/frontend-core","@angular/common/locales/ca","@angular/common/locales/es","@ag-grid-community/angular","@angular/cdk/a11y","@angular/cdk/drag-drop","@angular/cdk/portal","@angular/cdk/scrolling","@angular/cdk/stepper","@angular/cdk/table","@angular/cdk/tree","@angular/material/autocomplete","@angular/material/badge","@angular/material/bottom-sheet","@angular/material/button","@angular/material/button-toggle","@angular/material/card","@angular/material/checkbox","@angular/material/chips","@angular/material/stepper","@angular/material/datepicker","@angular/material/divider","@angular/material/expansion","@angular/material/grid-list","@angular/material/icon","@angular/material/input","@angular/material/list","@angular/material/menu","@angular/material/core","@angular/material/paginator","@angular/material/progress-bar","@angular/material/progress-spinner","@angular/material/radio","@angular/material/select","@angular/material/sidenav","@angular/material/slider","@angular/material/slide-toggle","@angular/material/snack-bar","@angular/material/sort","@angular/material/table","@angular/material/tabs","@angular/material/toolbar","@angular/material/tooltip","@angular/material/tree","@angular/material/form-field","@ngx-translate/http-loader","rxjs","@angular/cdk/collections","@angular/platform-browser","d3"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).sitmun=t.sitmun||{},t.sitmun["frontend-gui"]={}),t.ng.core,t.allModules,t.core$1,t.ng.material.dialog,t.ng.forms,t.ng.common,t.ng.common.http,t.ng.platformBrowser.animations,t.ng.router,t.frontendCore,t.ng.common.locales.ca,t.ng.common.locales.es,t.angular,t.ng.cdk.a11y,t.ng.cdk.dragDrop,t.ng.cdk.portal,t.ng.cdk.scrolling,t.ng.cdk.stepper,t.ng.cdk.table,t.ng.cdk.tree,t.ng.material.autocomplete,t.ng.material.badge,t.ng.material.bottomSheet,t.ng.material.button,t.ng.material.buttonToggle,t.ng.material.card,t.ng.material.checkbox,t.ng.material.chips,t.ng.material.stepper,t.ng.material.datepicker,t.ng.material.divider,t.ng.material.expansion,t.ng.material.gridList,t.ng.material.icon,t.ng.material.input,t.ng.material.list,t.ng.material.menu,t.ng.material.core,t.ng.material.paginator,t.ng.material.progressBar,t.ng.material.progressSpinner,t.ng.material.radio,t.ng.material.select,t.ng.material.sidenav,t.ng.material.slider,t.ng.material.slideToggle,t.ng.material.snackBar,t.ng.material.sort,t.ng.material.table,t.ng.material.tabs,t.ng.material.toolbar,t.ng.material.tooltip,t.ng.material.tree,t.ng.material.formField,t.httpLoader,t.rxjs,t.ng.cdk.collections,t.ng.platformBrowser,t.d3)}(this,(function(t,e,n,a,r,i,o,l,s,d,u,c,p,g,h,m,f,b,v,y,C,x,S,w,M,D,k,A,I,N,R,E,B,F,O,T,q,G,V,_,P,H,z,L,j,$,J,U,W,K,Q,X,Y,Z,tt,et,nt,at,rt,it){"use strict";function ot(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var lt=ot(c),st=ot(p);Object.create;function dt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],a=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&a>=t.length&&(t=void 0),{value:t&&t[a++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ut(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var a,r,i=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(a=i.next()).done;)o.push(a.value)}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}Object.create;var ct=function(){function t(){}return t.prototype.agInit=function(t){this.params=t},t.prototype.refresh=function(t){return!0},t.prototype.btnClickedHandler=function(t){this.params.clicked(this.params.value)},t.prototype.getParams=function(){return this.params},t.prototype.ngOnDestroy=function(){},t}();ct.decorators=[{type:e.Component,args:[{selector:"app-btn-edit-rendered",template:'<button mat-mini-fab class="buttonEdit"  type="button"  (click)="btnClickedHandler($event)" >\n  <mat-icon class="iconEdit"   fontSet="material-icons-round" > edit </mat-icon>\n</button> ',styles:[".buttonEdit{background-color:#ddd;box-shadow:none;color:#000;height:20px;margin-top:3px;width:20px}.iconEdit{font-size:13px;margin-left:-2px;margin-top:-10px}"]}]}];var pt=function(){function t(){}return t.prototype.agInit=function(t){this.params=t},t.prototype.refresh=function(t){return this.params=t,!0},t.prototype.invokeParentMethod=function(){this.params.context.componentParent.methodFromParent("Row: "+this.params.node.rowIndex+", Col: "+this.params.colDef.headerName)},t.prototype.btnCheckedHandler=function(t){var e=!t.target.firstElementChild.checked,n=this.params.column.colId;this.params.value=e,this.params.api.undoRedoService.isFilling=!0,this.params.node.setDataValue(n,e)},t.prototype.getParams=function(){return this.params},t.prototype.ngOnDestroy=function(){},t}();pt.decorators=[{type:e.Component,args:[{selector:"app-btn-checkbox-rendered",template:'<mat-checkbox (click)="btnCheckedHandler($event)" [value]="params.value" [checked]="params.value"> </mat-checkbox>',styles:[""]}]}];var gt=function(){function t(){this.text=""}return t.prototype.agInit=function(t){this.params=t,this.valueGetter=t.filterParams.valueGetter,this.params.suppressFilterButton=!0},t.prototype.isFilterActive=function(){return null!=this.text&&""!==this.text},t.prototype.doesFilterPass=function(t){var e=this;return this.text.toLowerCase().split(" ").every((function(n){return e.valueGetter(t.node).toString().toLowerCase().indexOf(n)>=0}))},t.prototype.getModel=function(){return{value:this.text}},t.prototype.setModel=function(t){this.text=t?t.value:""},t.prototype.onChange=function(t){this.params.parentFilterInstance((function(e){e.onFloatingFilterChanged("contains",t)}))},t.prototype.onParentModelChanged=function(t){this.currentValue=t?t.filter:0},t}();gt.decorators=[{type:e.Component,args:[{selector:"app-btn-checkbox-filter",template:'<select  #filterSelect  (change)=\'onChange(filterSelect.value)\'>\r\n    <option value="">{{"selectAll" | translate}}</option>\r\n    <option value="true">{{"enabled" | translate}}</option>\r\n    <option value="false">{{"disabled" | translate}}</option>\r\n  </select>',host:{class:"hostClass"},styles:[".hostClass{width:100%}"]}]}],gt.propDecorators={input:[{type:e.ViewChild,args:["input",{read:e.ViewContainerRef}]}]};var ht=function(){function t(t){this.dialogRef=t,this.hideCancelButton=!1}return t.prototype.ngOnInit=function(){},t.prototype.doAccept=function(){this.dialogRef.close({event:"Accept"})},t.prototype.closeDialog=function(){this.dialogRef.close({event:"Cancel"})},t}();ht.decorators=[{type:e.Component,args:[{selector:"app-dialog-message",template:'<h5 mat-dialog-title class="titleDialog">{{title}}</h5>\r\n<mat-dialog-content class="mat-typography">\r\n  <p>\r\n    {{message}}\r\n  </p>\r\n</mat-dialog-content>\r\n<mat-dialog-actions align="end">\r\n  <button mat-flat-button class="returnButton"  *ngIf="!hideCancelButton" (click)="closeDialog()">{{"cancel" | translate}}</button>\r\n  <button mat-flat-button class="saveButton"  (click)="doAccept()" cdkFocusInitial>{{"accept" | translate}}</button>\r\n</mat-dialog-actions>',styles:[".titleDialog{margin-bottom:15px!important;margin-top:inherit!important}"]}]}],ht.ctorParameters=function(){return[{type:r.MatDialogRef}]};var mt=function(){function t(t,a,r){var i=this;this.dialog=t,this.translate=a,this.elRef=r,this.modules=n.AllCommunityModules,this.statusColumn=!1,this.changesMap=new Map,this.modificationChange=!1,this.undoNoChanges=!1,this.someStatusHasChangedToDelete=!1,this.translate=a,this.frameworkComponents={btnEditRendererComponent:ct,btnCheckboxRendererComponent:pt,btnCheckboxFilterComponent:gt},this.remove=new e.EventEmitter,this.new=new e.EventEmitter,this.add=new e.EventEmitter,this.sendChanges=new e.EventEmitter,this.getSelectedRows=new e.EventEmitter,this.duplicate=new e.EventEmitter,this.getAllRows=new e.EventEmitter,this.changeCounter=0,this.previousChangeCounter=0,this.redoCounter=0,this.gridOptions={defaultColDef:{sortable:!0,flex:1,filter:!0,editable:!this.nonEditable,suppressMenu:!0,resizable:!0,cellStyle:function(t){return t.value&&t.colDef.editable&&i.changesMap.has(t.node.id)&&i.changesMap.get(t.node.id).has(t.colDef.field)?{"background-color":"#E8F1DE"}:{"background-color":"white"}}},rowSelection:"multiple",singleClickEdit:!0,localeTextFunc:function(t,e){var n=i.translate.instant(t);return n===t?e:n}}}return t.prototype.ngOnInit=function(){var t=this;this.eventRefreshSubscription&&(this._eventRefreshSubscription=this.eventRefreshSubscription.subscribe((function(){t.changesMap.clear(),t.someStatusHasChangedToDelete=!1,t.changeCounter=0,t.previousChangeCounter=0,t.redoCounter=0,t.getElements()}))),this.eventGetSelectedRowsSubscription&&(this._eventGetSelectedRowsSubscription=this.eventGetSelectedRowsSubscription.subscribe((function(){t.emitSelectedRows()}))),this.eventGetAllRowsSubscription&&(this._eventGetAllRowsSubscription=this.eventGetAllRowsSubscription.subscribe((function(){t.emitAllRows()}))),this.eventSaveAgGridStateSubscription&&(this._eventSaveAgGridStateSubscription=this.eventSaveAgGridStateSubscription.subscribe((function(){t.saveAgGridState()}))),this.eventAddItemsSubscription&&this.eventAddItemsSubscription.subscribe((function(e){t.addItems(e)}))},t.prototype.firstDataRendered=function(){if(null!=localStorage.agGridState){var t=JSON.parse(localStorage.agGridState);null!=t.idAgGrid&&t.idAgGrid==this.id?(this.gridApi.setFilterModel(t.filterState),this.gridColumnApi.setColumnState(t.colState),this.gridApi.setSortModel(t.sortState),this.searchValue=t.valueSearchGeneric,this.quickSearch(),this.removeAgGridState()):null!=this.id&&this.removeAgGridState()}},t.prototype.onGridReady=function(t){var e,n;this.singleSelection&&(this.gridOptions.rowSelection="single"),this.params=t,this.gridApi=t.api,this.gridColumnApi=t.columnApi;try{for(var a=dt(this.columnDefs),r=a.next();!r.done;r=a.next()){"status"===r.value.field&&(this.statusColumn=!0)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}if(this.getElements(),console.log(this.columnDefs),this.defaultColumnSorting){var i=[{colId:this.defaultColumnSorting,sort:"asc"}];this.gridApi.setSortModel(i)}null!=this.defaultHeight&&null!=this.defaultHeight&&this.changeHeight(this.defaultHeight)},t.prototype.areRowsSelected=function(){return null!=this.gridApi&&this.gridApi.getSelectedNodes().length>0},t.prototype.emitSelectedRows=function(){var t=this.gridApi.getSelectedNodes().map((function(t){return t.data}));this.getSelectedRows.emit(t)},t.prototype.emitAllRows=function(){var t=[];this.gridApi.forEachNode((function(e){return t.push(e.data)})),this.getAllRows.emit(t)},t.prototype.saveAgGridState=function(){var t={idAgGrid:this.id,colState:this.gridColumnApi.getColumnState(),filterState:this.gridApi.getFilterModel(),sortState:this.gridApi.getSortModel(),valueSearchGeneric:this.searchValue};localStorage.setItem("agGridState",JSON.stringify(t))},t.prototype.removeAgGridState=function(){localStorage.removeItem("agGridState")},t.prototype.getColumnKeysAndHeaders=function(t){var e=[];return 0==this.columnDefs.length?"":(this.gridOptions.columnApi.getAllDisplayedColumns().forEach((function(n){""!==n.userProvidedColDef.headerName&&(t.push(n.userProvidedColDef.field),e.push(n.userProvidedColDef.headerName))})),e.join(","))},t.prototype.exportData=function(){var t=[],e={onlySelected:!0,columnKeys:t,customHeader:this.getColumnKeysAndHeaders(t),skipHeader:!0};this.gridApi.exportDataAsCsv(e)},t.prototype.quickSearch=function(){this.gridApi.setQuickFilter(this.searchValue)},t.prototype.getElements=function(){var t=this;this.getAll().subscribe((function(e){t.statusColumn&&e.forEach((function(t){t.status="statusOK"})),t.rowData=e,t.gridApi.setRowData(t.rowData),t.setSize(),console.log(t.rowData)}))},t.prototype.setSize=function(){var t=[],e=this.gridOptions.columnApi.getAllColumns();e.forEach((function(e){t.push(e.colId)})),this.gridOptions.columnApi.autoSizeColumns(t);var n=this.gridOptions.api,a=n.gridPanel.eBodyViewport.clientWidth;n.gridPanel.columnController.getWidthOfColsInList(e)<a&&n.sizeColumnsToFit()},t.prototype.addItems=function(t){var e=this;console.log(t);var n=[];t.forEach((function(t){null==t.id||null==e.rowData.find((function(e){return e.id===t.id}))?(e.statusColumn&&(t.status="pendingCreation"),n.push(t),e.rowData.push(t)):console.log("Item with the ID "+t.id+" already exists")})),this.gridApi.updateRowData({add:n}),console.log(this.columnDefs)},t.prototype.changeHeight=function(t){var e="";e="5"===t?"200px":"10"===t?"315px":"20"===t?"630px":"1550px",this.elRef.nativeElement.parentElement.style.height=e},t.prototype.removeData=function(){var t,e;this.gridApi.stopEditing(!1);var n=this.gridApi.getSelectedNodes(),a=n.map((function(t){return t.data}));if(this.remove.emit(a),this.statusColumn){var r=n.map((function(t){return t.id}));r.length>0&&(this.someStatusHasChangedToDelete=!0);try{for(var i=dt(r),o=i.next();!o.done;o=i.next()){var l=o.value;this.gridApi.getRowNode(l).data.status="pendingDelete"}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.gridOptions.api.refreshCells()}this.gridOptions.api.deselectAll()},t.prototype.newData=function(){this.gridApi.stopEditing(!1),this.new.emit(-1)},t.prototype.onAddButtonClicked=function(){this.gridApi.stopEditing(!1),this.add.emit(-1)},t.prototype.onDuplicateButtonClicked=function(){var t=this;if(this.gridApi.stopEditing(!1),this.changeCounter>0){var e=this.dialog.open(ht);e.componentInstance.title=this.translate.instant("caution"),e.componentInstance.message=this.translate.instant("duplicateMessage"),e.afterClosed().subscribe((function(e){if(e&&"Accept"===e.event){var n=t.gridApi.getSelectedNodes().map((function(t){return t.data}));t.duplicate.emit(n)}}))}else{var n=this.gridApi.getSelectedNodes().map((function(t){return t.data}));this.duplicate.emit(n)}},t.prototype.applyChanges=function(){var t,e,n=[];this.gridApi.stopEditing(!1);try{for(var a=dt(this.changesMap.keys()),r=a.next();!r.done;r=a.next()){var i=r.value;n.push(this.gridApi.getRowNode(i).data)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}this.sendChanges.emit(n),this.changesMap.clear(),this.changeCounter=0,this.previousChangeCounter=0,this.redoCounter=0,this.someStatusHasChangedToDelete=!1,this.params.colDef.cellStyle={backgroundColor:"#FFFFFF"},this.gridApi.redrawRows()},t.prototype.deleteChanges=function(){for(this.gridApi.stopEditing(!1);this.changeCounter>0;)this.undo();this.changesMap.clear(),this.redoCounter=0,this.statusColumn&&(this.gridApi.forEachNode((function(t){"pendingModify"!==t.data.status&&"pendingDelete"!==t.data.status||(t.data.status="statusOK"),console.log(t)})),this.someStatusHasChangedToDelete=!1),this.gridApi.redrawRows()},t.prototype.onFilterModified=function(){this.deleteChanges()},t.prototype.undo=function(){this.gridApi.stopEditing(!1),this.gridApi.undoCellEditing(),this.changeCounter-=1,this.redoCounter+=1},t.prototype.redo=function(){this.gridApi.stopEditing(!1),this.gridApi.redoCellEditing(),this.changeCounter+=1,this.redoCounter-=1},t.prototype.onCellEditingStopped=function(t){this.modificationChange&&(this.changeCounter++,this.redoCounter=0,this.onCellValueChanged(t),this.modificationChange=!1)},t.prototype.onCellValueChanged=function(t){if(this.params=t,this.changeCounter>this.previousChangeCounter){if(t.oldValue!==t.value&&(null!=t.oldValue||""!==t.value)){if(this.changesMap.has(t.node.id))if(this.changesMap.get(t.node.id).has(t.colDef.field)){var e=this.changesMap.get(t.node.id).get(t.colDef.field);this.changesMap.get(t.node.id).set(t.colDef.field,e+1)}else this.changesMap.get(t.node.id).set(t.colDef.field,1);else{var n=new Map;n.set(t.colDef.field,1),this.changesMap.set(t.node.id,n),this.statusColumn&&"pendingCreation"!==this.gridApi.getRowNode(t.node.id).data.status&&(this.gridApi.getRowNode(t.node.id).data.status="pendingModify")}this.paintCells(t,this.changesMap),this.previousChangeCounter++}}else if(this.changeCounter<this.previousChangeCounter){e=-1;if(this.changesMap.has(t.node.id)&&(e=this.changesMap.get(t.node.id).get(t.colDef.field)),1===e)if(this.changesMap.get(t.node.id).delete(t.colDef.field),0===this.changesMap.get(t.node.id).size){this.changesMap.delete(t.node.id);var a=this.gridApi.getDisplayedRowAtIndex(t.rowIndex);this.statusColumn&&"pendingCreation"!==this.gridApi.getRowNode(t.node.id).data.status&&(this.gridApi.getRowNode(t.node.id).data.status="statusOK"),this.gridApi.redrawRows({rowNodes:[a]})}else this.paintCells(t,this.changesMap);else e>1&&(this.changesMap.get(t.node.id).set(t.colDef.field,e-1),this.paintCells(t,this.changesMap));this.previousChangeCounter--}else if(null!=t.oldValue||""!==t.value){var r=void 0;if(r=null==t.value?"":t.value.toString(),null!=t.oldValue&&null!=t.oldValue&&t.oldValue.toString()!==r.toString()||(null==t.oldValue||null==t.oldValue)&&null!=r){if(this.modificationChange=!0,"btnCheckboxRendererComponent"==t.colDef.cellRenderer){var i={cellValueChanges:this.gridApi.undoRedoService.cellValueChanges};this.gridApi.undoRedoService.pushActionsToUndoStack(i),this.gridApi.undoRedoService.isFilling=!1,this.onCellEditingStopped(t)}}else this.modificationWithoutChanges(t)}else this.modificationWithoutChanges(t)},t.prototype.modificationWithoutChanges=function(t){this.changesMap.has(t.node.id)?this.undoNoChanges?this.undoNoChanges=!1:(this.gridApi.undoCellEditing(),this.undoNoChanges=!0,this.paintCells(t,this.changesMap)):this.undoNoChanges?this.undoNoChanges=!1:(this.gridApi.undoCellEditing(),this.undoNoChanges=!0)},t.prototype.getColumnIndexByColId=function(t,e){return t.getAllColumns().findIndex((function(t){return t.getColId()===e}))},t.prototype.paintCells=function(t,e){var n=this.gridApi.getDisplayedRowAtIndex(t.rowIndex);this.gridApi.redrawRows({rowNodes:[n]})},t}();mt.decorators=[{type:e.Component,args:[{selector:"app-data-grid",template:'<div id=grup1 class="editDivBtns">\r\n    <span *ngIf="title" [translate]="title"> </span>\r\n    <button type="button" title="{{ \'cancel\' | translate }}" mat-mini-fab class="mini-fab mat-red" *ngIf="discardChangesButton"\r\n        id="deleteChangesButton" type="button" (click)="deleteChanges()" [disabled]="changeCounter <= 0 && !someStatusHasChangedToDelete">\r\n        <mat-icon fontSet="material-icons-round"> close </mat-icon>\r\n    </button>\r\n    <button type="button" title="{{ \'undo\' | translate }}" mat-mini-fab class="mini-fab mat-orange" *ngIf="undoButton"\r\n        id="undo" (click)="undo()" [disabled]="changeCounter <= 0">\r\n        <mat-icon fontSet="material-icons-round"> undo </mat-icon>\r\n    </button>\r\n    <button type="button" title="{{ \'redo\' | translate }}" mat-mini-fab class="mini-fab mat-orange" *ngIf="redoButton"\r\n        id="redo" (click)="redo()" [disabled]="redoCounter <= 0">\r\n        <mat-icon fontSet="material-icons-round"> redo </mat-icon>\r\n    </button>\r\n    <button type="button" title="{{ \'accept\' | translate }}" mat-mini-fab class="mini-fab mat-green"\r\n        *ngIf="applyChangesButton" id="applyChangesButton" (click)="applyChanges()" [disabled]="changeCounter <= 0">\r\n        <mat-icon fontSet="material-icons-round"> check </mat-icon>\r\n    </button>\r\n</div>\r\n\r\n<div id=grup2 class="actionsDivBtns">\r\n    <label *ngIf="globalSearch" [translate]="\'search\'"> </label>\r\n    <input *ngIf="globalSearch" type="text" class="searchGenericInput" placeholder="" (keyup)="quickSearch()"\r\n        [(ngModel)]="searchValue" ml-2>\r\n    <label *ngIf="changeHeightButton" [translate]="\'rowsToShow\'"> </label>\r\n    <mat-button-toggle-group *ngIf="changeHeightButton" class="toogleButton" name="fontStyle" aria-label="Font Style"  value="5">\r\n        <mat-button-toggle value="5" (change)="changeHeight($event.value)">5</mat-button-toggle>\r\n        <mat-button-toggle value="20" (change)="changeHeight($event.value)">20</mat-button-toggle>\r\n        <mat-button-toggle value="50" (change)="changeHeight($event.value)">50</mat-button-toggle>\r\n    </mat-button-toggle-group>\r\n\r\n    <button type="button" *ngIf="deleteButton" mat-flat-button id="deleteButton" class="deleteButton"\r\n        (click)="removeData()" [disabled]="!areRowsSelected()">\r\n        <mat-icon fontSet="material-icons-round"> delete </mat-icon>\r\n        <span [translate]="\'remove\'"> </span>\r\n\r\n    </button>\r\n    <button type="button" *ngIf="actionButton" mat-flat-button [matMenuTriggerFor]="menu" id="actionButton"\r\n        class="actionButton">\r\n        <span [translate]="\'actions\'"> </span>\r\n        <mat-icon fontSet="material-icons-round"> keyboard_arrow_down </mat-icon>\r\n    </button>\r\n    <mat-menu #menu="matMenu">\r\n        <button type="button" mat-menu-item *ngIf="!hideExportButton" (click)="exportData()"> {{"export" | translate}}\r\n        </button>\r\n        <button type="button" mat-menu-item *ngIf="!hideDuplicateButton" (click)="onDuplicateButtonClicked()">\r\n            {{"duplicate" |\r\n            translate}}</button>\r\n        <button type="button" mat-menu-item *ngIf="!hideSearchReplaceButton && false"> {{"search/replace" | translate}}</button>\r\n    </mat-menu>\r\n\r\n    <button type="button" *ngIf="newButton" mat-flat-button class="newButton" (click)="newData()">\r\n        <mat-icon fontSet="material-icons-round"> add_circle_outline </mat-icon>\r\n        <span [translate]="\'new\'"> </span>\r\n    </button>\r\n    <button type="button" *ngIf="addButton" mat-flat-button class="newButton" (click)="onAddButtonClicked()">\r\n        <mat-icon fontSet="material-icons-round"> add_circle_outline </mat-icon>\r\n        <span [translate]="\'add\'"> </span>\r\n    </button>\r\n\r\n</div>\r\n\r\n<div class="row" style=" height: 100%">\r\n    <div id="myGrid" style=" width:100%; height: 100%">\r\n        <ag-grid-angular style="width: 100%; height: 100%;min-height: 200px;" [class]="themeGrid"\r\n            [floatingFilter]="true" [rowData]="rowData" [columnDefs]="columnDefs" [gridOptions]="gridOptions"\r\n            [animateRows]="true" [pagination]="false" [modules]="modules" [undoRedoCellEditing]="true"\r\n            [undoRedoCellEditingLimit]=200 [suppressRowClickSelection]=true [frameworkComponents]="frameworkComponents"\r\n            rowSelection="multiple" multiSortKey="key" (filterModified)="onFilterModified()"\r\n            (cellEditingStopped)="onCellEditingStopped($event)" (cellValueChanged)="onCellValueChanged($event)"\r\n            (gridReady)="onGridReady($event)" (firstDataRendered)="firstDataRendered()">\r\n        </ag-grid-angular>\r\n    </div>\r\n</div>',styles:['@charset "UTF-8";input,label{display:inline-block;margin:5px 5px 5px 10px}.mat-flat-button.mat-orange,.mat-icon.mat-orange,.mat-mini-fab.mat-orange,.mat-raised-button.mat-orange{background-color:#ff9300!important;color:#fff!important}.mat-flat-button.mat-orange:disabled,.mat-icon.mat-orange:disabled,.mat-mini-fab.mat-orange:disabled,.mat-raised-button.mat-orange:disabled{background:#ffc97f!important;color:#fff!important}.mat-flat-button.mat-green,.mat-icon.mat-green,.mat-mini-fab.mat-green,.mat-raised-button.mat-green{background-color:#68a225!important;color:#fff!important}.mat-flat-button.mat-green:disabled,.mat-icon.mat-green:disabled,.mat-mini-fab.mat-green:disabled,.mat-raised-button.mat-green:disabled{background-color:#83976c!important;color:#fff!important}.mat-flat-button.mat-red,.mat-icon.mat-red,.mat-mini-fab.mat-red,.mat-raised-button.mat-red{background-color:#bf0000!important;color:#fff!important}.mat-flat-button.mat-red:disabled,.mat-icon.mat-red:disabled,.mat-mini-fab.mat-red:disabled,.mat-raised-button.mat-red:disabled{background-color:#da8c8e!important;color:#fff!important}.validateButton{background-color:#ff9300;color:#fff;margin-top:34px!important;min-width:85px}.deleteButton,.validateButton{-ms-grid-column-align:right!important;height:40px;justify-self:right!important}.deleteButton{border:1px solid #bf0000!important;color:#bf0000;float:inherit!important;min-width:85px!important}.deleteButton:disabled{background-color:inherit!important;border:1px solid rgba(0,0,0,.26)!important;color:rgba(0,0,0,.26) solid 1px!important}.actionButton,.returnButton{border:1px solid #ff9300!important;color:#ff9300}.actionButton,.newButton,.returnButton,.saveButton{-ms-grid-column-align:right!important;float:inherit!important;height:40px;justify-self:right!important;min-width:85px!important}.newButton,.saveButton{background-color:#68a225;color:#fff}.editDivBtns{height:30px!important;line-height:30px!important;margin-left:10px;text-align:start;width:130px}.actionsDivBtns{height:50px;text-align:end;width:calc(100% - 140px)}.actionsDivBtns,.editDivBtns{display:inline-block!important}.actionsDivBtns .searchGenericInput{display:inline-block!important;height:41px!important;margin:0 5px 5px 10px!important;width:45%!important}.ag-body-viewport.ag-layout-normal ::-webkit-scrollbar-thumb{background:#eee}​ .ag-body-viewport.ag-layout-normal ::-webkit-scrollbar{height:2em;width:2em}.ag-body-viewport.ag-layout-normal ::-webkit-scrollbar-button{background:#ccc}.ag-body-viewport.ag-layout-normal::-webkit-scrollbar-track-piece{background:#888}.mini-fab{height:28px!important;line-height:22px!important;margin-right:3px!important;margin-top:7px!important;width:28px!important}.mini-fab .mat-button-wrapper{height:24px!important;line-height:22px!important;padding:1px 0!important;width:24px!important}.mini-fab .mat-button-wrapper .mat-icon{font-size:20px;line-height:22px;padding-right:0}.toogleButton{align-items:center;height:40px;margin-right:10px;vertical-align:bottom}']}]}],mt.ctorParameters=function(){return[{type:r.MatDialog},{type:a.TranslateService},{type:e.ElementRef}]},mt.propDecorators={eventRefreshSubscription:[{type:e.Input}],eventGetSelectedRowsSubscription:[{type:e.Input}],eventGetAllRowsSubscription:[{type:e.Input}],eventSaveAgGridStateSubscription:[{type:e.Input}],eventAddItemsSubscription:[{type:e.Input}],frameworkComponents:[{type:e.Input}],columnDefs:[{type:e.Input}],getAll:[{type:e.Input}],discardChangesButton:[{type:e.Input}],id:[{type:e.Input}],undoButton:[{type:e.Input}],defaultColumnSorting:[{type:e.Input}],redoButton:[{type:e.Input}],applyChangesButton:[{type:e.Input}],deleteButton:[{type:e.Input}],newButton:[{type:e.Input}],actionButton:[{type:e.Input}],addButton:[{type:e.Input}],globalSearch:[{type:e.Input}],changeHeightButton:[{type:e.Input}],defaultHeight:[{type:e.Input}],themeGrid:[{type:e.Input}],singleSelection:[{type:e.Input}],nonEditable:[{type:e.Input}],title:[{type:e.Input}],hideExportButton:[{type:e.Input}],hideDuplicateButton:[{type:e.Input}],hideSearchReplaceButton:[{type:e.Input}],remove:[{type:e.Output}],new:[{type:e.Output}],add:[{type:e.Output}],sendChanges:[{type:e.Output}],duplicate:[{type:e.Output}],getSelectedRows:[{type:e.Output}],getAllRows:[{type:e.Output}],getAgGridState:[{type:e.Output}]};var ft=function(){};function bt(){}ft.decorators=[{type:e.NgModule,args:[{exports:[h.A11yModule,v.CdkStepperModule,y.CdkTableModule,C.CdkTreeModule,m.DragDropModule,x.MatAutocompleteModule,S.MatBadgeModule,w.MatBottomSheetModule,M.MatButtonModule,D.MatButtonToggleModule,k.MatCardModule,A.MatCheckboxModule,I.MatChipsModule,N.MatStepperModule,R.MatDatepickerModule,r.MatDialogModule,E.MatDividerModule,B.MatExpansionModule,F.MatGridListModule,O.MatIconModule,T.MatInputModule,q.MatListModule,G.MatMenuModule,V.MatNativeDateModule,_.MatPaginatorModule,P.MatProgressBarModule,H.MatProgressSpinnerModule,z.MatRadioModule,V.MatRippleModule,L.MatSelectModule,j.MatSidenavModule,$.MatSliderModule,J.MatSlideToggleModule,U.MatSnackBarModule,W.MatSortModule,K.MatTableModule,Q.MatTabsModule,X.MatToolbarModule,Y.MatTooltipModule,Z.MatTreeModule,f.PortalModule,b.ScrollingModule,tt.MatFormFieldModule]}]}],bt.prototype._GetAllsTable,bt.prototype._columnDefsTable,bt.prototype._singleSelectionTable;var vt=function(){function t(t){this.dialogRef=t,this.getAllRows=new nt.Subject,this.allRowsReceived=[],this.joinTables=new e.EventEmitter,this.tablesReceivedCounter=0}return t.prototype.ngOnInit=function(){var t=this;this.addButtonClickedSubscription&&(this._addButtonClickedSubscription=this.addButtonClickedSubscription.subscribe((function(){t.getAllSelectedRows()})))},t.prototype.getAllSelectedRows=function(){this.getAllRows.next(!0)},t.prototype.joinRowsReceived=function(t){this.allRowsReceived.push(t),this.tablesReceivedCounter++,this.tablesReceivedCounter===this.getAllsTable.length&&(this.doAdd(this.allRowsReceived),console.log(this.allRowsReceived))},t.prototype.doAdd=function(t){this.dialogRef.close({event:"Add",data:t})},t.prototype.closeDialog=function(){this.dialogRef.close({event:"Cancel"})},t}();vt.decorators=[{type:e.Component,args:[{selector:"app-dialog-grid",template:'<h5 mat-dialog-title class="titleDialog">{{title}}</h5>\r\n<mat-dialog-content class="dialogConent">\r\n  <div *ngFor="let getAll of getAllsTable; let i = index" class="appDialogDataGridDiv"  [ngStyle]="{\'margin-top\': i>0?\'100px\':\'0px\'}">\r\n    <app-data-grid \r\n    [columnDefs]="columnDefsTable[i]" [themeGrid]=\'themeGrid\' [changeHeightButton]=\'changeHeightButton\' [defaultHeight]=\'heightByDefault\'  [getAll]=\'getAll\' [globalSearch]=true [singleSelection]="singleSelectionTable[i]"\r\n    [title]="titlesTable[i]" [nonEditable]=\'nonEditable\' [eventGetSelectedRowsSubscription]="getAllRows.asObservable()" (getSelectedRows)=\'joinRowsReceived($event)\' >\r\n    </app-data-grid>\r\n  </div>\r\n</mat-dialog-content>\r\n<div mat-dialog-actions align="end">\r\n  <button mat-flat-button class="returnButton" (click)="closeDialog()">{{"cancel" | translate}}</button>\r\n  <button mat-flat-button class="saveButton" (click)="getAllSelectedRows()" cdkFocusInitial>{{"add" | translate}}</button>\r\n</div>\r\n\r\n',styles:[".dialogConent{height:100%;margin:inherit!important;max-height:60vh!important;overflow:auto;padding:inherit!important;width:100%}.titleDialog{margin-bottom:15px!important;margin-top:inherit!important}"]}]}],vt.ctorParameters=function(){return[{type:r.MatDialogRef}]},vt.propDecorators={joinTables:[{type:e.Output}]};var yt=function(){function t(t,e,n){this.dialogRef=t,this.dialog=e,this.translate=n}return t.prototype.ngOnInit=function(){},t.prototype.doAdd=function(){if(this.form.valid)this.dialogRef.close({event:"Add"});else{var t=this.dialog.open(ht);t.componentInstance.title=this.translate.instant("atention"),t.componentInstance.message=this.translate.instant("requiredFieldMessage"),t.componentInstance.hideCancelButton=!0,t.afterClosed().subscribe()}},t.prototype.closeDialog=function(){this.dialogRef.close({event:"Cancel"})},t}();yt.decorators=[{type:e.Component,args:[{selector:"app-dialog-form",template:'<h5 mat-dialog-title>{{title}}</h5>\r\n<mat-dialog-content class="mat-typography">\r\n  <ng-container *ngTemplateOutlet="HTMLReceived">\r\n  </ng-container> \r\n</mat-dialog-content>\r\n<mat-dialog-actions align="end">\r\n  <button mat-flat-button class="returnButton"  (click)="closeDialog()">{{"cancel" | translate}}</button>\r\n  <button mat-flat-button class="saveButton"  (click)="doAdd()" cdkFocusInitial>{{"accept" | translate}}</button>\r\n</mat-dialog-actions>',styles:[""]}]}],yt.ctorParameters=function(){return[{type:r.MatDialogRef},{type:r.MatDialog},{type:a.TranslateService}]};var Ct=function(){};var xt=function(t,e,n,a,r,i){this.expandable=t,this.name=e,this.level=n,this.type=a,this.id=r,this.status=i};var St=function(){function t(){this.dataChange=new nt.BehaviorSubject([])}return Object.defineProperty(t.prototype,"data",{get:function(){return this.dataChange.value},enumerable:!1,configurable:!0}),t.prototype.initialize=function(t){var e=this.buildFileTree(t,0);this.dataChange.next(e)},t.prototype.buildFileTree=function(t,e){var n={};if(0===t.length){n.root={isFolder:!0,name:"Root",type:"folder",isRoot:!0,order:0,children:[],id:0}}else t.forEach((function(t){var e=t;if(e.children=[],e.type=t.isFolder?"folder":"node",n[e.id]){var a=n[e.id].children;n[e.id]=e,n[e.id].children=a}else n[e.id]=e;var r=e.parent||"root";n[r]||(n[r]={children:[]}),n[r].children.push(e)})),n.root.type="folder",n.root.name="Root",n.root.order=0,n.root.isFolder=!0,n.root.isRoot=!0;return n.root},t.prototype.deleteItem=function(t,e){this.deleteNode(e.children,t),this.dataChange.next(e)},t.prototype.deleteNode=function(t,e){var n=this,a=t.indexOf(e,0);a>-1?t.splice(a,1):t.forEach((function(t){t.children&&t.children.length>0&&n.deleteNode(t.children,e)}))},t.prototype.copyPasteItem=function(t,e,n){return this.insertItem(e,t,n)},t.prototype.copyPasteItemAbove=function(t,e,n){return this.insertItemAbove(e,t,n)},t.prototype.copyPasteItemBelow=function(t,e,n){return this.insertItemBelow(e,t,n)},t.prototype.getNewItem=function(t){return{name:t.name,children:t.children,type:t.type,id:t.id,active:t.active,cartographyId:t.cartographyId,cartographyName:t.cartographyName,datasetURL:t.datasetURL,description:t.description,filterGetFeatureInfo:t.filterGetFeatureInfo,filterGetMap:t.filterGetMap,filterSelectable:t.filterSelectable,isFolder:t.isFolder,metadataURL:t.metadataURL,order:t.order,queryableActive:t.queryableActive,radio:t.radio,tooltip:t.tooltip,_links:t._links}},t.prototype.insertItem=function(t,e,n){t.children||(t.children=[]);var a=this.getNewItem(e);return a.parent=null==t||null==t.id?null:t.id,t.children.push(a),this.dataChange.next(n),a},t.prototype.insertItemAbove=function(t,e,n){var a=this.getParentFromNodes(t,n),r=this.getNewItem(e);return r.parent=null==a||null==a.id?null:a.id,null!=a?a.children.splice(a.children.indexOf(t),0,r):n.children.splice(n.children.indexOf(t),0,r),this.dataChange.next(n),r},t.prototype.insertItemBelow=function(t,e,n){var a=this.getParentFromNodes(t,n),r=this.getNewItem(e);return r.parent=null==a||null==a.id?null:a.id,null!=a?a.children.splice(a.children.indexOf(t)+1,0,r):n.children.splice(n.children.indexOf(t)+1,0,r),this.dataChange.next(n),r},t.prototype.getParentFromNodes=function(t,e){for(var n=0;n<e.children.length;++n){var a=e.children[n],r=this.getParent(a,t);if(null!=r)return r}return null},t.prototype.getParent=function(t,e){if(t.children&&t.children.length>0)for(var n=0;n<t.children.length;++n){var a=t.children[n];if(a===e)return t;if(a.children&&a.children.length>0){var r=this.getParent(a,e);if(null!=r)return r}}return null},t}();St.decorators=[{type:e.Injectable}],St.ctorParameters=function(){return[]};var wt=function(){function t(t){var n=this;this.database=t,this.expansionModel=new at.SelectionModel(!0),this.dragging=!1,this.expandDelay=1e3,this.validateDrop=!1,this.dragNodeExpandOverWaitTimeMs=1500,this.flatNodeMap=new Map,this.nestedNodeMap=new Map,this.transformer=function(t,e){var a=n.nestedNodeMap.get(t),r=a&&a.name===t.name?a:new xt(t.children&&t.children.length>0,t.name,e,t.type,t.id,t.status);return n.flatNodeMap.set(r,t),n.nestedNodeMap.set(t,r),r},this._getLevel=function(t){return t.level},this._isExpandable=function(t){return t.expandable},this._getChildren=function(t){return nt.of(t.children)},this.hasChild=function(t,e){return e.expandable},this.emitNode=new e.EventEmitter,this.createNode=new e.EventEmitter,this.createFolder=new e.EventEmitter,this.emitAllNodes=new e.EventEmitter,this.treeFlattener=new Z.MatTreeFlattener(this.transformer,this._getLevel,this._isExpandable,this._getChildren),this.treeControl=new C.FlatTreeControl(this._getLevel,this._isExpandable),this.dataSource=new Z.MatTreeFlatDataSource(this.treeControl,this.treeFlattener)}return t.prototype.ngOnInit=function(){var t=this;this.eventNodeUpdatedSubscription&&this.eventNodeUpdatedSubscription.subscribe((function(e){t.updateNode(e)})),this.eventCreateNodeSubscription&&this.eventCreateNodeSubscription.subscribe((function(e){e.isFolder?t.createNewFolder(e):t.createNewNode(e)})),this.eventGetAllRowsSubscription&&(this._eventGetAllRowsSubscription=this.eventGetAllRowsSubscription.subscribe((function(){t.emitAllRows()}))),this.eventRefreshSubscription&&(this._eventRefreshSubscription=this.eventRefreshSubscription.subscribe((function(){t.getElements()}))),this.getElements()},t.prototype.getElements=function(){var t=this;this.getAll().subscribe((function(e){t.treeData=e,t.database.initialize(t.treeData),t.database.dataChange.subscribe((function(e){return t.rebuildTreeForData([e])}))}))},t.prototype.visibleNodes=function(){var t=this,e=[];return this.dataSource.data.forEach((function(n){!function t(n,a){e.push(n),-1!=a.indexOf(n.id)&&n.children.map((function(e){return t(e,a)}))}(n,t.expansionModel.selected)})),e},t.prototype.findNodeSiblings=function(t,e){var n,a,r=this;return t.forEach((function(i,o){i.id===e?n=t:i.children&&(a=r.findNodeSiblings(i.children,e))&&(n=a)})),n},t.prototype.handleDragStart=function(t,e){t.dataTransfer.setData("foo","bar"),t.dataTransfer.setDragImage(this.emptyItem.nativeElement,0,0),this.dragNode=e,this.treeControl.collapse(e)},t.prototype.handleDragOver=function(t,e){t.preventDefault(),e===this.dragNodeExpandOverNode?this.dragNode===e||this.treeControl.isExpanded(e)||(new Date).getTime()-this.dragNodeExpandOverTime>this.dragNodeExpandOverWaitTimeMs&&this.treeControl.expand(e):(this.dragNodeExpandOverNode=e,this.dragNodeExpandOverTime=(new Date).getTime());t.offsetX,t.target.clientWidth;var n=t.offsetY/t.target.clientHeight;this.dragNodeExpandOverArea=n<.25?"above":n>.75?"below":"center"},t.prototype.handleDrop=function(t,e){var n=this;t.preventDefault();var a=JSON.parse(JSON.stringify(this.dataSource.data)),r=this.findNodeSiblings(a[0].children,e.id).find((function(t){return t.id===e.id})),i=this.findNodeSiblings(a[0].children,this.dragNode.id).find((function(t){return t.id===n.dragNode.id}));if("pendingDelete"!=this.dragNode.status&&e!==this.dragNode&&("center"!==this.dragNodeExpandOverArea||"center"===this.dragNodeExpandOverArea&&r.isFolder)){var o=void 0;o="above"===this.dragNodeExpandOverArea?this.database.copyPasteItemAbove(i,r,a[0]):"below"===this.dragNodeExpandOverArea?this.database.copyPasteItemBelow(i,r,a[0]):this.database.copyPasteItem(i,r,a[0]);var l=this.treeControl.dataNodes.find((function(t){return t.id===i.id})).level;i.children.forEach((function(t){n.treeControl.dataNodes.find((function(e){return e.id===t.id})).level=l+1})),this.database.deleteItem(i,a[0]),this.treeControl.expandDescendants(this.nestedNodeMap.get(o))}this.dragNode=null,this.dragNodeExpandOverNode=null,this.dragNodeExpandOverTime=0},t.prototype.handleDragEnd=function(t){this.dragNode=null,this.dragNodeExpandOverNode=null,this.dragNodeExpandOverTime=0},t.prototype.sortByOrder=function(t){var e=this;t.sort((function(t,e){return t.order.toString().localeCompare(e.order.toString())})),t.forEach((function(t){t.children.length>0&&e.sortByOrder(t.children)}))},t.prototype.rebuildTreeForData=function(t){var e=this;this.sortByOrder(t),this.dataSource.data=[],this.dataSource.data=t,this.treeControl.expansionModel.selected.forEach((function(t){var n=e.treeControl.dataNodes.find((function(e){return e.id===t.id}));e.treeControl.expand(n)}))},t.prototype.getParentNode=function(t){var e=t.level;if(e<1)return null;for(var n=this.treeControl.dataNodes.indexOf(t)-1;n>=0;n--){var a=this.treeControl.dataNodes[n];if(a.level<e)return a}return null},t.prototype.updateNode=function(t){var e=JSON.parse(JSON.stringify(this.dataSource.data)),n=this.findNodeSiblings(e,t.id),a=n.findIndex((function(e){return e.id===t.id}));n[a]=t,this.rebuildTreeForData(e)},t.prototype.createNewFolder=function(t){t.type="folder";var e=JSON.parse(JSON.stringify(this.dataSource.data));if(null===t.parent)t.order=e[0].children.length,e[0].children.push(t);else{var n=this.findNodeSiblings(e,t.parent),a=n.findIndex((function(e){return e.id===t.parent}));t.order=n[a].children.length,n[a].children.push(t)}this.rebuildTreeForData(e)},t.prototype.createNewNode=function(t){t.type="node";var e=JSON.parse(JSON.stringify(this.dataSource.data));if(null===t.parent)t.order=e[0].children.length,e[0].children.push(t);else{var n=this.findNodeSiblings(e,t.parent),a=n.findIndex((function(e){return e.id===t.parent}));t.order=n[a].children.length,n[a].children.push(t)}this.rebuildTreeForData(e)},t.prototype.onButtonClicked=function(t,e){var n=JSON.parse(JSON.stringify(this.dataSource.data)),a=this.findNodeSiblings(n,t).find((function(e){return e.id===t}));"edit"===e?this.emitNode.emit(a):"newFolder"===e?this.createFolder.emit(a):"newNode"===e?this.createNode.emit(a):"delete"===e&&(this.deleteChildren(a.children),a.status="pendingDelete",this.rebuildTreeForData(n))},t.prototype.emitAllRows=function(){var t=JSON.parse(JSON.stringify(this.dataSource.data)),e=this.getAllChildren(t);this.emitAllNodes.emit(e)},t.prototype.getAllChildren=function(t){var e,n=this,a=[];return t.forEach((function(t,r){t.children.length>0&&(e=n.getAllChildren(t.children))&&a.push.apply(a,function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ut(arguments[e]));return t}(e)),a.push(t)})),a},t.prototype.deleteChildren=function(t){var e=this;t.forEach((function(t,n){t.children.length>0&&e.deleteChildren(t.children),t.status="pendingDelete"}))},t}();wt.decorators=[{type:e.Component,args:[{selector:"app-data-tree",template:"<mat-tree [dataSource]=\"dataSource\" [treeControl]=\"treeControl\" >\r\n\t<mat-tree-node *matTreeNodeDef=\"let node\" matTreeNodeToggle matTreeNodePadding  draggable=\"true\"\r\n\t(dragstart)=\"handleDragStart($event, node);\" \t(dragover)=\"handleDragOver($event, node);\"\r\n\t(drop)=\"handleDrop($event, node);\" \t(dragend)=\"handleDragEnd($event);\"                  \r\n\t  [ngClass]=\"{'drop-above': dragNodeExpandOverArea === 'above' && dragNodeExpandOverNode === node,\r\n\t'drop-below': dragNodeExpandOverArea === 'below' && dragNodeExpandOverNode === node,\r\n\t'drop-center': dragNodeExpandOverArea === 'center' && dragNodeExpandOverNode === node,\r\n\t'deletedNode': node.status=='pendingDelete'}\">\r\n\t\t<button mat-icon-button disabled></button>\r\n\t\t<mat-icon *ngIf=\"node.type ==='folder'&& node.status!='pendingDelete'\" class=\"type-icon\" [attr.aria-label]=\"node.type + 'icon'\">\r\n\t\t\tfolder\r\n\t\t</mat-icon>\r\n\t\t<span *ngIf=\"node.status=='pendingDelete'\">({{\"pendingDelete\" | translate}})-</span>\r\n\t\t{{node.name}}\r\n\t\r\n\t\t<button *ngIf=\"node.type ==='folder' && node.status!='pendingDelete'\" (click)=\"onButtonClicked(node.id, 'newFolder')\" mat-icon-button>\r\n\t\t\t<mat-icon>create_new_folder</mat-icon>\r\n\t\t</button>\r\n\t\t<button *ngIf=\"node.type ==='folder' && node.status!='pendingDelete'\" (click)=\"onButtonClicked(node.id, 'newNode')\" mat-icon-button>\r\n\t\t\t<mat-icon>playlist_add</mat-icon>\r\n\t\t</button>\r\n\t\t<button *ngIf=\"node.id !== undefined && node.status!='pendingDelete'\" mat-icon-button (click)=\"onButtonClicked(node.id, 'delete')\">\r\n\t\t\t<mat-icon>delete</mat-icon>\r\n\t\t</button>\r\n\t\t<button *ngIf=\"node.id !== undefined && node.status!='pendingDelete'\" mat-icon-button (click)=\"onButtonClicked(node.id, 'edit')\">\r\n\t\t\t<mat-icon>edit</mat-icon>\r\n\t\t</button>\r\n\r\n\t</mat-tree-node>\r\n\r\n\t<mat-tree-node *matTreeNodeDef=\"let node;when: hasChild\" matTreeNodePadding  draggable=\"true\"\r\n\t(dragstart)=\"handleDragStart($event, node);\" \t(dragover)=\"handleDragOver($event, node);\"\r\n\t(drop)=\"handleDrop($event, node);\" \t(dragend)=\"handleDragEnd($event);\"                  \r\n\t [ngClass]=\"{'drop-above': dragNodeExpandOverArea === 'above' && dragNodeExpandOverNode === node,\r\n\t'drop-below': dragNodeExpandOverArea === 'below' && dragNodeExpandOverNode === node,\r\n\t'drop-center': dragNodeExpandOverArea === 'center' && dragNodeExpandOverNode === node,\r\n\t'deletedNode': node.status=='pendingDelete'}\">\r\n\t\t<button mat-icon-button matTreeNodeToggle (click)=\"expansionModel.toggle(node.id)\"\r\n\t\t\t[attr.aria-label]=\"'toggle ' + node.name\">\r\n\t\t\t<mat-icon class=\"mat-icon-rtl-mirror\">\r\n\t\t\t\t{{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}\r\n\t\t\t</mat-icon>\r\n\t\t</button>\r\n\t\t<mat-icon class=\"type-icon\" [attr.aria-label]=\"node.type + 'icon'\">\r\n\t\t\tfolder\r\n\t\t</mat-icon>\r\n\t\t<span *ngIf=\"node.status=='pendingDelete'\">({{\"pendingDelete\" | translate}})-</span>\r\n\t\t{{node.name}}\r\n\t\t<button *ngIf=\"node.type ==='folder' && node.status!='pendingDelete'\" (click)=\"onButtonClicked(node.id, 'newFolder')\" mat-icon-button>\r\n\t\t\t<mat-icon>create_new_folder</mat-icon>\r\n\t\t</button>\r\n\t\t<button *ngIf=\"node.type ==='folder' && node.status!='pendingDelete'\" (click)=\"onButtonClicked(node.id, 'newNode')\" mat-icon-button>\r\n\t\t\t<mat-icon>playlist_add</mat-icon>\r\n\t\t</button>\r\n\t\t<button *ngIf=\"node.id !== undefined && node.status!='pendingDelete'\" mat-icon-button (click)=\"onButtonClicked(node.id, 'delete')\">\r\n\t\t\t<mat-icon>delete</mat-icon>\r\n\t\t</button>\r\n\t\t<button *ngIf=\"node.id !== undefined && node.status!='pendingDelete'\"  mat-icon-button (click)=\"onButtonClicked(node.id, 'edit')\">\r\n\t\t\t<mat-icon>edit</mat-icon>\r\n\t\t</button>\r\n\t\t\r\n\t</mat-tree-node>\r\n</mat-tree>\r\n\r\n<span #emptyItem></span>\r\n",providers:[St],styles:[".mat-tree-node{-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;cursor:move;user-select:none}.mat-tree-node.cdk-drag-preview{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 12px 17px 2px rgba(0,0,0,.14),0 5px 22px 4px rgba(0,0,0,.12)}.mat-tree-node.cdk-drag-placeholder{opacity:0}.cdk-drop-list-dragging .mat-tree-node:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-animating{transition:transform .2s cubic-bezier(0,0,.2,1)}.drop-above{border-top:10px solid #ddd;margin-top:-10px}.drop-below{border-bottom:10px solid #ddd;margin-bottom:-10px}.drop-center{background-color:#ddd}.deletedNode{color:red;font-style:italic}"]}]}],wt.ctorParameters=function(){return[{type:St}]},wt.propDecorators={createNode:[{type:e.Output}],createFolder:[{type:e.Output}],emitNode:[{type:e.Output}],emitAllNodes:[{type:e.Output}],eventNodeUpdatedSubscription:[{type:e.Input}],eventCreateNodeSubscription:[{type:e.Input}],eventGetAllRowsSubscription:[{type:e.Input}],eventRefreshSubscription:[{type:e.Input}],getAll:[{type:e.Input}],emptyItem:[{type:e.ViewChild,args:["emptyItem"]}]};var Mt=function(){function t(t,e,n){this.dialogRef=t,this.matIconRegistry=e,this.domSanitizer=n,this.initializeTranslationForm(),this.matIconRegistry.addSvgIcon("icon_lang_ca",this.domSanitizer.bypassSecurityTrustResourceUrl("../../assets/img/flag_ca.svg")),this.matIconRegistry.addSvgIcon("icon_lang_es",this.domSanitizer.bypassSecurityTrustResourceUrl("../../assets/img/flag_es.svg")),this.matIconRegistry.addSvgIcon("icon_lang_en",this.domSanitizer.bypassSecurityTrustResourceUrl("../../assets/img/flag_en.svg")),this.matIconRegistry.addSvgIcon("icon_lang_oc",this.domSanitizer.bypassSecurityTrustResourceUrl("../../assets/img/flag_oc.svg"))}return t.prototype.ngOnInit=function(){null!=this.catalanValue&&this.translationForm.patchValue({catalanValue:this.catalanValue}),null!=this.spanishValue&&this.translationForm.patchValue({spanishValue:this.spanishValue}),null!=this.englishValue&&this.translationForm.patchValue({englishValue:this.englishValue}),null!=this.araneseValue&&this.translationForm.patchValue({araneseValue:this.araneseValue})},t.prototype.initializeTranslationForm=function(){this.translationForm=new i.FormGroup({catalanValue:new i.FormControl(null,[]),spanishValue:new i.FormControl(null,[]),englishValue:new i.FormControl(null,[]),araneseValue:new i.FormControl(null,[])})},t.prototype.doAccept=function(){var t={catalanValue:this.translationForm.value.catalanValue,spanishValue:this.translationForm.value.spanishValue,englishValue:this.translationForm.value.englishValue,araneseValue:this.translationForm.value.araneseValue};this.dialogRef.close({event:"Accept",data:t})},t.prototype.closeDialog=function(){this.dialogRef.close({event:"Cancel"})},t}();Mt.decorators=[{type:e.Component,args:[{selector:"app-dialog-translation",template:'\r\n\r\n<form [formGroup]=\'translationForm\' #f="ngForm">\r\n\r\n\r\n        <div class="displayInline">\r\n            <label class="formLabelDialog">\r\n                {{\'value\' | translate}}\r\n            </label>\r\n            <mat-form-field appearance="outline">\r\n            <input matInput type="text" formControlName="catalanValue" required>\r\n            </mat-form-field>\r\n            <mat-icon class="icon" svgIcon="icon_lang_ca"></mat-icon>\r\n        </div>\r\n\r\n        <div class="displayInline">\r\n            <label class="formLabelDialog">\r\n                {{\'value\' | translate}}\r\n            </label>\r\n\r\n            <mat-form-field appearance="outline">\r\n            <input matInput type="text" formControlName="spanishValue">\r\n            </mat-form-field>\r\n            <mat-icon class="icon" svgIcon="icon_lang_es"></mat-icon>\r\n        </div>\r\n\r\n        <div class="displayInline">\r\n            <label class="formLabelDialog">\r\n                {{\'value\' | translate}}\r\n            </label>\r\n            <mat-form-field appearance="outline">\r\n            <input matInput type="text" formControlName="englishValue">\r\n            </mat-form-field>\r\n            <mat-icon class="icon" svgIcon="icon_lang_en"></mat-icon>\r\n        </div>\r\n\r\n        <div class="displayInline">\r\n            <label class="formLabelDialog">\r\n                {{\'value\' | translate}}\r\n            </label>\r\n            <mat-form-field appearance="outline">\r\n            <input matInput type="text" formControlName="araneseValue">\r\n            </mat-form-field>\r\n            <mat-icon class="icon" svgIcon="icon_lang_oc"></mat-icon>\r\n        </div>\r\n\r\n\r\n  </form>\r\n\r\n<div>\r\n    <div mat-dialog-actions >\r\n        <button  mat-flat-button class="returnButton" (click)="closeDialog()">{{"cancel" | translate}}</button>\r\n        <button  mat-flat-button class="saveButton"  (click)="doAccept()" cdkFocusInitial>{{"accept" | translate}}</button>\r\n    </div>\r\n</div>',styles:[".displayInline{display:flex!important}.mat-dialog-actions{justify-content:flex-end}.icon{height:50px!important;margin-left:30px;width:40px!important}.formLabelDialog{width:10%!important}.mat-dialog-container{height:-webkit-max-content!important;height:-moz-max-content!important;height:max-content!important}"]}]}],Mt.ctorParameters=function(){return[{type:r.MatDialogRef},{type:O.MatIconRegistry},{type:rt.DomSanitizer}]};var Dt=function(){function t(){this.margin={top:20,bottom:60,left:40,right:40},this.margin2=80}return t.prototype.ngOnInit=function(){"bar"==this.type&&(this.createBarChart(),this.data&&this.updateBarChart())},t.prototype.ngOnChanges=function(){"bar"==this.type&&this.chart&&this.updateBarChart()},t.prototype.createBarChart=function(){var t=this,e=this.chartContainer.nativeElement;this.width=e.offsetWidth-this.margin.left-this.margin.right,this.height=e.offsetHeight-this.margin.top-this.margin.bottom;var n=it.select(e).append("svg").attr("width","100%").attr("height","100%");this.chart=n.append("g").attr("class","bars").attr("transform","translate("+this.margin.left+", "+this.margin.top+")");var a=this.chart.selectAll().data(this.data).enter().append("g"),r=this.data.map((function(t){return t.index})),i=[0,it.max(this.data,(function(t){return t.value}))];this.xScale=it.scaleBand().padding(.3).domain(r).rangeRound([0,this.width]),this.yScale=it.scaleLinear().domain(i).range([this.height,0]),a.append("text").attr("class","value").attr("x",(function(e){return t.xScale(e.index)+t.xScale.bandwidth()/2})).attr("y",(function(e){return t.yScale(e.value)-5})).attr("text-anchor","middle").style("font-size",9).style("fill","black").text((function(t){return""+t.value})),this.xAxis=n.append("g").attr("class","axis axis-x").attr("transform","translate("+this.margin.left+", "+(this.margin.top+this.height)+")").call(it.axisBottom(this.xScale)).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end").style("font-size",9).style("fill","black"),this.yAxis=n.append("g").attr("class","axis axis-y").attr("transform","translate("+this.margin.left+", "+this.margin.top+")").call(it.axisLeft(this.yScale)).selectAll("text").style("font-size",9).style("fill","black")},t.prototype.updateBarChart=function(){var t=this;this.xScale.domain(this.data.map((function(t){return t.index}))),this.yScale.domain([0,it.max(this.data,(function(t){return t.value}))]),this.xAxis.transition().call(it.axisBottom(this.xScale)),this.yAxis.transition().call(it.axisLeft(this.yScale));var e=this.chart.selectAll(".bar").data(this.data);e.exit().remove(),this.chart.selectAll(".bar").transition().attr("x",(function(e){return t.xScale(e.index)})).attr("y",(function(e){return t.yScale(e.value)})).attr("width",(function(e){return t.xScale.bandwidth()})).attr("height",(function(e){return t.height-t.yScale(e[1])})).style("fill","#be7d27"),e.enter().append("rect").attr("class","bar").attr("x",(function(e){return t.xScale(e.index)})).attr("y",(function(e){return t.yScale(e.value)})).attr("height",(function(e){return t.height-t.yScale(e.value)})).attr("width",this.xScale.bandwidth()).style("fill","#be7d27").transition().delay((function(t,e){return 10*e}))},t}();function kt(t){return new et.TranslateHttpLoader(t,"../assets/i18n/",".json")}Dt.decorators=[{type:e.Component,args:[{selector:"app-datagraph",template:'<div class="d3-chart" #chart></div>',styles:[".d3-chart{background-color:rgba(189,185,181,.615686274509804);height:400px;margin:auto;width:100%}.d3-chart .axis line,.d3-chart .axis path{stroke:#999}.d3-chart .axis text{fill:#999}body{font-family:Open Sans,sans-serif}div#layout{text-align:center}svg{height:100%;width:100%}.bar{fill:#be7d27}text{fill:#fff;font-size:8px!important}line,path{stroke:grey}line#limit{stroke:#fed966;stroke-dasharray:3 6;stroke-width:3}.grid path{stroke-width:0}.grid .tick line{stroke:#9faaae;stroke-opacity:.3}text.divergence{fill:#2f4a6d;font-size:12px}.bars.value{font-size:8px!important;z-index:132132132}text.title{font-size:22px;font-weight:600}text.label{font-weight:400}text.label,text.source{font-size:8px!important}"]}]}],Dt.ctorParameters=function(){return[]},Dt.propDecorators={chartContainer:[{type:e.ViewChild,args:["chart",{static:!0}]}],data:[{type:e.Input}],type:[{type:e.Input}]},o.registerLocaleData(lt.default,"ca"),o.registerLocaleData(st.default,"es");var At=kt,It=function(){};It.decorators=[{type:e.NgModule,args:[{imports:[d.RouterModule,l.HttpClientModule,o.CommonModule,i.FormsModule,s.NoopAnimationsModule,u.AngularHalModule,i.ReactiveFormsModule,s.BrowserAnimationsModule,g.AgGridModule,u.SitmunFrontendCoreModule,ft,a.TranslateModule.forRoot({loader:{provide:a.TranslateLoader,useFactory:At,deps:[l.HttpClient]}})],declarations:[mt,wt,ct,pt,gt,vt,yt,ht,Mt,Dt],entryComponents:[],providers:[],exports:[l.HttpClientModule,o.CommonModule,i.FormsModule,s.NoopAnimationsModule,u.AngularHalModule,a.TranslateModule,i.ReactiveFormsModule,mt,wt,vt,yt,ht,Mt,Dt,u.SitmunFrontendCoreModule]}]}],t.BtnCheckboxFilterComponent=gt,t.BtnCheckboxRenderedComponent=pt,t.BtnEditRenderedComponent=ct,t.DataGridComponent=mt,t.DataTreeComponent=wt,t.DatagraphComponent=Dt,t.DialogFormComponent=yt,t.DialogGridComponent=vt,t.DialogMessageComponent=ht,t.DialogTranslationComponent=Mt,t.FileDatabase=St,t.FileFlatNode=xt,t.FileNode=Ct,t.SitmunFrontendGuiModule=It,t.createTranslateLoader=kt,t.ɵa=ft,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=sitmun-frontend-gui.umd.min.js.map